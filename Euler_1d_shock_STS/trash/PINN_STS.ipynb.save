{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#!/usr/bin/env python\n",
    "# coding: utf-8\n",
    "\n",
    "# Physics Informed Neural Network (PINN) in Tensorflow\n",
    "\n",
    "%matplotlib notebook\n",
    "\n",
    "import time\n",
    "import sys\n",
    "sys.path.insert(0, './utilities')\n",
    "\n",
    "import tensorflow as tf\n",
    "\n",
    "import numpy as np\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "import scipy.io\n",
    "from scipy.interpolate import griddata\n",
    "\n",
    "from plotting import newfig, savefig\n",
    "from mpl_toolkits.axes_grid1 import make_axes_locatable\n",
    "from itertools import product, combinations\n",
    "import matplotlib.gridspec as gridspec\n",
    "\n",
    "from sklearn.preprocessing import MinMaxScaler\n",
    "\n",
    "from sklearn.model_selection  import train_test_split\n",
    "from sklearn.model_selection import cross_val_score\n",
    "from sklearn.model_selection import KFold, StratifiedKFold\n",
    "\n",
    "from sklearn.pipeline import Pipeline\n",
    "\n",
    "from sklearn.preprocessing import MinMaxScaler\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from sklearn.preprocessing import RobustScaler\n",
    "from sklearn.preprocessing import minmax_scale\n",
    "from sklearn.preprocessing import MaxAbsScaler\n",
    "from sklearn.preprocessing import Normalizer\n",
    "from sklearn.preprocessing import QuantileTransformer\n",
    "from sklearn.preprocessing import PowerTransformer\n",
    "\n",
    "# Tensorflow random seed for initialization\n",
    "np.random.seed(1234)\n",
    "tf.compat.v1.set_random_seed(1234)\n",
    "\n",
    "# Define the Class PINN which we are going to use\n",
    "class PINN:\n",
    "\n",
    "    # Initialize the class\n",
    "    def __init__(self,\n",
    "                 x, n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12, n13, n14, n15, n16, n17, n18,\n",
    "                 n19, n20, n21, n22, n23, n24, n25, n26, n27, n28, n29, n30, n31, n32, n33, n34,\n",
    "                 n35, n36, n37, n38, n39, n40, n41, n42, n43, n44, n45, n46, n47, nat,\n",
    "                 rho, u, p, E,\n",
    "                 R1, R2, R3, R4, R5, R6, R7, R8, R9, R10, R11, R12, R13, R14, R15, R16, R17, R18,\n",
    "                 R19, R20, R21, R22, R23, R24, R25, R26, R27, R28, R29, R30, R31, R32, R33, R34,\n",
    "                 R35, R36, R37, R38, R39, R40, R41, R42, R43, R44, R45, R46, R47, Rat, layers):\n",
    "\n",
    "        # Create Input Matrix for the given training data point\n",
    "        X = np.concatenate([x], 1)\n",
    "\n",
    "        # min & max for normalization\n",
    "        self.lb = X.min(0)\n",
    "        self.ub = X.max(0)\n",
    "\n",
    "        self.X  = X\n",
    "\n",
    "        # class attribute definitions\n",
    "        self.x   = x\n",
    "\n",
    "        self.n1  = n1\n",
    "        self.n2  = n2\n",
    "        self.n3  = n3\n",
    "        self.n4  = n4\n",
    "        self.n5  = n5\n",
    "        self.n6  = n6\n",
    "        self.n7  = n7\n",
    "        self.n8  = n8\n",
    "        self.n9  = n9\n",
    "        self.n10 = n10\n",
    "        self.n11 = n11\n",
    "        self.n12 = n12\n",
    "        self.n13 = n13\n",
    "        self.n14 = n14\n",
    "        self.n15 = n15\n",
    "        self.n16 = n16\n",
    "        self.n17 = n17\n",
    "        self.n18 = n18\n",
    "        self.n19 = n19\n",
    "        self.n20 = n20\n",
    "        self.n21 = n21\n",
    "        self.n22 = n22\n",
    "        self.n23 = n23\n",
    "        self.n24 = n24\n",
    "        self.n25 = n25\n",
    "        self.n26 = n26\n",
    "        self.n27 = n27\n",
    "        self.n28 = n28\n",
    "        self.n29 = n29\n",
    "        self.n30 = n30\n",
    "        self.n31 = n31\n",
    "        self.n32 = n32\n",
    "        self.n33 = n33\n",
    "        self.n34 = n34\n",
    "        self.n35 = n35\n",
    "        self.n36 = n36\n",
    "        self.n37 = n37\n",
    "        self.n38 = n38\n",
    "        self.n39 = n39\n",
    "        self.n40 = n40\n",
    "        self.n41 = n41\n",
    "        self.n42 = n42\n",
    "        self.n43 = n43\n",
    "        self.n44 = n44\n",
    "        self.n45 = n45\n",
    "        self.n46 = n46\n",
    "        self.n47 = n47\n",
    "        self.nat = nat\n",
    "\n",
    "        self.rho = rho\n",
    "        self.u   = u\n",
    "        self.p   = p\n",
    "        self.E   = E\n",
    "\n",
    "        self.R1  = R1\n",
    "        self.R2  = R2\n",
    "        self.R3  = R3\n",
    "        self.R4  = R4\n",
    "        self.R5  = R5\n",
    "        self.R6  = R6\n",
    "        self.R7  = R7\n",
    "        self.R8  = R8\n",
    "        self.R9  = R9\n",
    "        self.R10 = R10\n",
    "        self.R11 = R11\n",
    "        self.R12 = R12\n",
    "        self.R13 = R13\n",
    "        self.R14 = R14\n",
    "        self.R15 = R15\n",
    "        self.R16 = R16\n",
    "        self.R17 = R17\n",
    "        self.R18 = R18\n",
    "        self.R19 = R19\n",
    "        self.R20 = R20\n",
    "        self.R21 = R21\n",
    "        self.R22 = R22\n",
    "        self.R23 = R23\n",
    "        self.R24 = R24\n",
    "        self.R25 = R25\n",
    "        self.R26 = R26\n",
    "        self.R27 = R27\n",
    "        self.R28 = R28\n",
    "        self.R29 = R29\n",
    "        self.R30 = R30\n",
    "        self.R31 = R31\n",
    "        self.R32 = R32\n",
    "        self.R33 = R33\n",
    "        self.R34 = R34\n",
    "        self.R35 = R35\n",
    "        self.R36 = R36\n",
    "        self.R37 = R37\n",
    "        self.R38 = R38\n",
    "        self.R39 = R39\n",
    "        self.R40 = R40\n",
    "        self.R41 = R41\n",
    "        self.R42 = R42\n",
    "        self.R43 = R43\n",
    "        self.R44 = R44\n",
    "        self.R45 = R45\n",
    "        self.R46 = R46\n",
    "        self.R47 = R47\n",
    "        self.Rat = Rat\n",
    "\n",
    "        self.layers = layers\n",
    "\n",
    "        # Initialize NN\n",
    "        # initialize_NN is another class method which is used to assign random\n",
    "        # weights and bias terms to the network. This not only initializes the\n",
    "        # network but also structures the sizes and values of all the weights and\n",
    "        # biases that would be so required for the network defined by layers.\n",
    "        self.weights, self.biases = self.initialize_NN(layers)\n",
    "\n",
    "        # Define a session to run\n",
    "        # tf placeholders and graph\n",
    "        self.sess = tf.compat.v1.Session(config=tf.compat.v1.ConfigProto(allow_soft_placement=True,\n",
    "                                                                         log_device_placement=True))\n",
    "\n",
    "        # Define tensors for each variable using tf.placeholder, with shape\n",
    "        # similar to their numpy counterparts variable_Name\n",
    "        self.x_tf   = tf.compat.v1.placeholder(tf.float32, shape=[None, self.x.shape[1]])\n",
    "\n",
    "        self.rho_tf = tf.compat.v1.placeholder(tf.float32, shape=[None, self.rho.shape[1]])\n",
    "        self.u_tf   = tf.compat.v1.placeholder(tf.float32, shape=[None, self.u.shape[1]])\n",
    "        self.p_tf   = tf.compat.v1.placeholder(tf.float32, shape=[None, self.p.shape[1]])\n",
    "        self.E_tf   = tf.compat.v1.placeholder(tf.float32, shape=[None, self.E.shape[1]])\n",
    "\n",
    "        self.n1_tf  = tf.placeholder(tf.float32, shape=[None, self.n1.shape[1]])\n",
    "        self.n2_tf  = tf.placeholder(tf.float32, shape=[None, self.n2.shape[1]])\n",
    "        self.n3_tf  = tf.placeholder(tf.float32, shape=[None, self.n3.shape[1]])\n",
    "        self.n4_tf  = tf.placeholder(tf.float32, shape=[None, self.n4.shape[1]])\n",
    "        self.n5_tf  = tf.placeholder(tf.float32, shape=[None, self.n5.shape[1]])\n",
    "        self.n6_tf  = tf.placeholder(tf.float32, shape=[None, self.n6.shape[1]])\n",
    "        self.n7_tf  = tf.placeholder(tf.float32, shape=[None, self.n7.shape[1]])\n",
    "        self.n8_tf  = tf.placeholder(tf.float32, shape=[None, self.n8.shape[1]])\n",
    "        self.n9_tf  = tf.placeholder(tf.float32, shape=[None, self.n9.shape[1]])\n",
    "        self.n10_tf = tf.placeholder(tf.float32, shape=[None, self.n10.shape[1]])\n",
    "        self.n11_tf = tf.placeholder(tf.float32, shape=[None, self.n11.shape[1]])\n",
    "        self.n12_tf = tf.placeholder(tf.float32, shape=[None, self.n12.shape[1]])\n",
    "        self.n13_tf = tf.placeholder(tf.float32, shape=[None, self.n13.shape[1]])\n",
    "        self.n14_tf = tf.placeholder(tf.float32, shape=[None, self.n14.shape[1]])\n",
    "        self.n15_tf = tf.placeholder(tf.float32, shape=[None, self.n15.shape[1]])\n",
    "        self.n16_tf = tf.placeholder(tf.float32, shape=[None, self.n16.shape[1]])\n",
    "        self.n17_tf = tf.placeholder(tf.float32, shape=[None, self.n17.shape[1]])\n",
    "        self.n18_tf = tf.placeholder(tf.float32, shape=[None, self.n18.shape[1]])\n",
    "        self.n19_tf = tf.placeholder(tf.float32, shape=[None, self.n19.shape[1]])\n",
    "        self.n20_tf = tf.placeholder(tf.float32, shape=[None, self.n20.shape[1]])\n",
    "        self.n21_tf = tf.placeholder(tf.float32, shape=[None, self.n21.shape[1]])\n",
    "        self.n22_tf = tf.placeholder(tf.float32, shape=[None, self.n22.shape[1]])\n",
    "        self.n23_tf = tf.placeholder(tf.float32, shape=[None, self.n23.shape[1]])\n",
    "        self.n24_tf = tf.placeholder(tf.float32, shape=[None, self.n24.shape[1]])\n",
    "        self.n25_tf = tf.placeholder(tf.float32, shape=[None, self.n25.shape[1]])\n",
    "        self.n26_tf = tf.placeholder(tf.float32, shape=[None, self.n26.shape[1]])\n",
    "        self.n27_tf = tf.placeholder(tf.float32, shape=[None, self.n27.shape[1]])\n",
    "        self.n28_tf = tf.placeholder(tf.float32, shape=[None, self.n28.shape[1]])\n",
    "        self.n29_tf = tf.placeholder(tf.float32, shape=[None, self.n29.shape[1]])\n",
    "        self.n30_tf = tf.placeholder(tf.float32, shape=[None, self.n30.shape[1]])\n",
    "        self.n31_tf = tf.placeholder(tf.float32, shape=[None, self.n31.shape[1]])\n",
    "        self.n32_tf = tf.placeholder(tf.float32, shape=[None, self.n32.shape[1]])\n",
    "        self.n33_tf = tf.placeholder(tf.float32, shape=[None, self.n33.shape[1]])\n",
    "        self.n34_tf = tf.placeholder(tf.float32, shape=[None, self.n34.shape[1]])\n",
    "        self.n35_tf = tf.placeholder(tf.float32, shape=[None, self.n35.shape[1]])\n",
    "        self.n36_tf = tf.placeholder(tf.float32, shape=[None, self.n36.shape[1]])\n",
    "        self.n37_tf = tf.placeholder(tf.float32, shape=[None, self.n37.shape[1]])\n",
    "        self.n38_tf = tf.placeholder(tf.float32, shape=[None, self.n38.shape[1]])\n",
    "        self.n39_tf = tf.placeholder(tf.float32, shape=[None, self.n39.shape[1]])\n",
    "        self.n40_tf = tf.placeholder(tf.float32, shape=[None, self.n40.shape[1]])\n",
    "        self.n41_tf = tf.placeholder(tf.float32, shape=[None, self.n41.shape[1]])\n",
    "        self.n42_tf = tf.placeholder(tf.float32, shape=[None, self.n42.shape[1]])\n",
    "        self.n43_tf = tf.placeholder(tf.float32, shape=[None, self.n43.shape[1]])\n",
    "        self.n44_tf = tf.placeholder(tf.float32, shape=[None, self.n44.shape[1]])\n",
    "        self.n45_tf = tf.placeholder(tf.float32, shape=[None, self.n45.shape[1]])\n",
    "        self.n46_tf = tf.placeholder(tf.float32, shape=[None, self.n46.shape[1]])\n",
    "        self.n47_tf = tf.placeholder(tf.float32, shape=[None, self.n47.shape[1]])\n",
    "        self.nat_tf = tf.placeholder(tf.float32, shape=[None, self.nat.shape[1]])\n",
    "\n",
    "        self.R1_tf  = tf.placeholder(tf.float32, shape=[None, self.R1.shape[1]])\n",
    "        self.R2_tf  = tf.placeholder(tf.float32, shape=[None, self.R2.shape[1]])\n",
    "        self.R3_tf  = tf.placeholder(tf.float32, shape=[None, self.R3.shape[1]])\n",
    "        self.R4_tf  = tf.placeholder(tf.float32, shape=[None, self.R4.shape[1]])\n",
    "        self.R5_tf  = tf.placeholder(tf.float32, shape=[None, self.R5.shape[1]])\n",
    "        self.R6_tf  = tf.placeholder(tf.float32, shape=[None, self.R6.shape[1]])\n",
    "        self.R7_tf  = tf.placeholder(tf.float32, shape=[None, self.R7.shape[1]])\n",
    "        self.R8_tf  = tf.placeholder(tf.float32, shape=[None, self.R8.shape[1]])\n",
    "        self.R9_tf  = tf.placeholder(tf.float32, shape=[None, self.R9.shape[1]])\n",
    "        self.R10_tf = tf.placeholder(tf.float32, shape=[None, self.R10.shape[1]])\n",
    "        self.R11_tf = tf.placeholder(tf.float32, shape=[None, self.R11.shape[1]])\n",
    "        self.R12_tf = tf.placeholder(tf.float32, shape=[None, self.R12.shape[1]])\n",
    "        self.R13_tf = tf.placeholder(tf.float32, shape=[None, self.R13.shape[1]])\n",
    "        self.R14_tf = tf.placeholder(tf.float32, shape=[None, self.R14.shape[1]])\n",
    "        self.R15_tf = tf.placeholder(tf.float32, shape=[None, self.R15.shape[1]])\n",
    "        self.R16_tf = tf.placeholder(tf.float32, shape=[None, self.R16.shape[1]])\n",
    "        self.R17_tf = tf.placeholder(tf.float32, shape=[None, self.R17.shape[1]])\n",
    "        self.R18_tf = tf.placeholder(tf.float32, shape=[None, self.R18.shape[1]])\n",
    "        self.R19_tf = tf.placeholder(tf.float32, shape=[None, self.R19.shape[1]])\n",
    "        self.R20_tf = tf.placeholder(tf.float32, shape=[None, self.R20.shape[1]])\n",
    "        self.R21_tf = tf.placeholder(tf.float32, shape=[None, self.R21.shape[1]])\n",
    "        self.R22_tf = tf.placeholder(tf.float32, shape=[None, self.R22.shape[1]])\n",
    "        self.R23_tf = tf.placeholder(tf.float32, shape=[None, self.R23.shape[1]])\n",
    "        self.R24_tf = tf.placeholder(tf.float32, shape=[None, self.R24.shape[1]])\n",
    "        self.R25_tf = tf.placeholder(tf.float32, shape=[None, self.R25.shape[1]])\n",
    "        self.R26_tf = tf.placeholder(tf.float32, shape=[None, self.R26.shape[1]])\n",
    "        self.R27_tf = tf.placeholder(tf.float32, shape=[None, self.R27.shape[1]])\n",
    "        self.R28_tf = tf.placeholder(tf.float32, shape=[None, self.R28.shape[1]])\n",
    "        self.R29_tf = tf.placeholder(tf.float32, shape=[None, self.R29.shape[1]])\n",
    "        self.R30_tf = tf.placeholder(tf.float32, shape=[None, self.R30.shape[1]])\n",
    "        self.R31_tf = tf.placeholder(tf.float32, shape=[None, self.R31.shape[1]])\n",
    "        self.R32_tf = tf.placeholder(tf.float32, shape=[None, self.R32.shape[1]])\n",
    "        self.R33_tf = tf.placeholder(tf.float32, shape=[None, self.R33.shape[1]])\n",
    "        self.R34_tf = tf.placeholder(tf.float32, shape=[None, self.R34.shape[1]])\n",
    "        self.R35_tf = tf.placeholder(tf.float32, shape=[None, self.R35.shape[1]])\n",
    "        self.R36_tf = tf.placeholder(tf.float32, shape=[None, self.R36.shape[1]])\n",
    "        self.R37_tf = tf.placeholder(tf.float32, shape=[None, self.R37.shape[1]])\n",
    "        self.R38_tf = tf.placeholder(tf.float32, shape=[None, self.R38.shape[1]])\n",
    "        self.R39_tf = tf.placeholder(tf.float32, shape=[None, self.R39.shape[1]])\n",
    "        self.R40_tf = tf.placeholder(tf.float32, shape=[None, self.R40.shape[1]])\n",
    "        self.R41_tf = tf.placeholder(tf.float32, shape=[None, self.R41.shape[1]])\n",
    "        self.R42_tf = tf.placeholder(tf.float32, shape=[None, self.R42.shape[1]])\n",
    "        self.R43_tf = tf.placeholder(tf.float32, shape=[None, self.R43.shape[1]])\n",
    "        self.R44_tf = tf.placeholder(tf.float32, shape=[None, self.R44.shape[1]])\n",
    "        self.R45_tf = tf.placeholder(tf.float32, shape=[None, self.R45.shape[1]])\n",
    "        self.R46_tf = tf.placeholder(tf.float32, shape=[None, self.R46.shape[1]])\n",
    "        self.R47_tf = tf.placeholder(tf.float32, shape=[None, self.R47.shape[1]])\n",
    "        self.Rat_tf = tf.placeholder(tf.float32, shape=[None, self.Rat.shape[1]])\n",
    "\n",
    "        # Predict the values of output by a single forward propagation.\n",
    "        # Also get AutoDiff coefficients from the same class method: net_Euler_STS\n",
    "        [self.n1_pred,  self.n2_pred,  self.n3_pred,  self.n4_pred,  self.n5_pred,  self.n6_pred,  self.n7_pred,  self.n8_pred,\n",
    "         self.n9_pred,  self.n10_pred, self.n11_pred, self.n12_pred, self.n13_pred, self.n14_pred, self.n15_pred, self.n16_pred,\n",
    "         self.n17_pred, self.n18_pred, self.n19_pred, self.n20_pred, self.n21_pred, self.n22_pred, self.n23_pred, self.n24_pred,\n",
    "         self.n25_pred, self.n26_pred, self.n27_pred, self.n28_pred, self.n29_pred, self.n30_pred, self.n31_pred, self.n32_pred,\n",
    "         self.n33_pred, self.n34_pred, self.n35_pred, self.n36_pred, self.n37_pred, self.n38_pred, self.n39_pred, self.n40_pred,\n",
    "         self.n41_pred, self.n42_pred, self.n43_pred, self.n44_pred, self.n45_pred, self.n46_pred, self.n47_pred, self.nat_pred,\n",
    "         self.rho_pred, self.u_pred,   self.p_pred,   self.E_pred,\n",
    "         #####\n",
    "         self.R1_pred,  self.R2_pred,  self.R3_pred,  self.R4_pred,  self.R5_pred,  self.R6_pred,  self.R7_pred,  self.R8_pred,\n",
    "         self.R9_pred,  self.R10_pred, self.R11_pred, self.R12_pred, self.R13_pred, self.R14_pred, self.R15_pred, self.R16_pred,\n",
    "         self.R17_pred, self.R18_pred, self.R19_pred, self.R20_pred, self.R21_pred, self.R22_pred, self.R23_pred, self.R24_pred,\n",
    "         self.R25_pred, self.R26_pred, self.R27_pred, self.R28_pred, self.R29_pred, self.R30_pred, self.R31_pred, self.R32_pred,\n",
    "         self.R33_pred, self.R34_pred, self.R35_pred, self.R36_pred, self.R37_pred, self.R38_pred, self.R39_pred, self.R40_pred,\n",
    "         self.R41_pred, self.R42_pred, self.R43_pred, self.R44_pred, self.R45_pred, self.R46_pred, self.R47_pred, self.Rat_pred,\n",
    "         #####\n",
    "         self.e1,   self.e2,   self.e3,   self.e4,\n",
    "         self.en1,  self.en2,  self.en3,  self.en4,  self.en5,  self.en6,  self.en7,  self.en8,  self.en9,  self.en10, self.en11,\n",
    "         self.en12, self.en13, self.en14, self.en15, self.en16, self.en17, self.en18, self.en19, self.en20, self.en21, self.en22,\n",
    "         self.en23, self.en24, self.en25, self.en26, self.en27, self.en28, self.en29, self.en30, self.en31, self.en32, self.en33,\n",
    "         self.en34, self.en35, self.en36, self.en37, self.en38, self.en39, self.en40, self.en41, self.en42, self.en43, self.en44,\n",
    "         self.en45, self.en46, self.en47, self.enat] = self.net_Euler_STS(self.x_tf)\n",
    "\n",
    "        # MSE Normalization\n",
    "        # The initial normalization terms are necessary to ensure that the\n",
    "        # gradients don't get driven towards either the residual aquared errors\n",
    "        # or the MSE of the outputs. Basically, to ensure equal weightage to it\n",
    "        # being 'trained to training data' as well as being 'Physics informed\n",
    "        rho_norm = np.amax(rho)\n",
    "        u_norm   = np.amax(u)\n",
    "        p_norm   = np.amax(p)\n",
    "        E_norm   = np.amax(E)\n",
    "\n",
    "        e1_norm  = rho_norm*u_norm        #*S_norm # e1 is continuity residual\n",
    "        e2_norm  = p_norm                 #*S_norm # e2 is momentum   residual\n",
    "        e3_norm  = E_norm*rho_norm*u_norm #*S_norm # e3 is energy     residual\n",
    "\n",
    "        n1_norm  = np.amax(n1)\n",
    "        n2_norm  = np.amax(n2)\n",
    "        n3_norm  = np.amax(n3)\n",
    "        n4_norm  = np.amax(n4)\n",
    "        n5_norm  = np.amax(n5)\n",
    "        n6_norm  = np.amax(n6)\n",
    "        n7_norm  = np.amax(n7)\n",
    "        n8_norm  = np.amax(n8)\n",
    "        n9_norm  = np.amax(n9)\n",
    "        n10_norm = np.amax(n10)\n",
    "        n11_norm = np.amax(n11)\n",
    "        n12_norm = np.amax(n12)\n",
    "        n13_norm = np.amax(n13)\n",
    "        n14_norm = np.amax(n14)\n",
    "        n15_norm = np.amax(n15)\n",
    "        n16_norm = np.amax(n16)\n",
    "        n17_norm = np.amax(n17)\n",
    "        n18_norm = np.amax(n18)\n",
    "        n19_norm = np.amax(n19)\n",
    "        n20_norm = np.amax(n20)\n",
    "        n21_norm = np.amax(n21)\n",
    "        n22_norm = np.amax(n22)\n",
    "        n23_norm = np.amax(n23)\n",
    "        n24_norm = np.amax(n24)\n",
    "        n25_norm = np.amax(n25)\n",
    "        n26_norm = np.amax(n26)\n",
    "        n27_norm = np.amax(n27)\n",
    "        n28_norm = np.amax(n28)\n",
    "        n29_norm = np.amax(n29)\n",
    "        n30_norm = np.amax(n30)\n",
    "        n31_norm = np.amax(n31)\n",
    "        n32_norm = np.amax(n32)\n",
    "        n33_norm = np.amax(n33)\n",
    "        n34_norm = np.amax(n34)\n",
    "        n35_norm = np.amax(n35)\n",
    "        n36_norm = np.amax(n36)\n",
    "        n37_norm = np.amax(n37)\n",
    "        n38_norm = np.amax(n38)\n",
    "        n39_norm = np.amax(n39)\n",
    "        n40_norm = np.amax(n40)\n",
    "        n41_norm = np.amax(n41)\n",
    "        n42_norm = np.amax(n42)\n",
    "        n43_norm = np.amax(n43)\n",
    "        n44_norm = np.amax(n44)\n",
    "        n45_norm = np.amax(n45)\n",
    "        n46_norm = np.amax(n46)\n",
    "        n47_norm = np.amax(n47)\n",
    "        nat_norm = np.amax(nat)\n",
    "\n",
    "        en1_norm  = n1_norm *u_norm\n",
    "        en2_norm  = n2_norm *u_norm\n",
    "        en3_norm  = n3_norm *u_norm\n",
    "        en4_norm  = n4_norm *u_norm\n",
    "        en5_norm  = n5_norm *u_norm\n",
    "        en6_norm  = n6_norm *u_norm\n",
    "        en7_norm  = n7_norm *u_norm\n",
    "        en8_norm  = n8_norm *u_norm\n",
    "        en9_norm  = n9_norm *u_norm\n",
    "        en10_norm = n10_norm*u_norm\n",
    "        en11_norm = n11_norm*u_norm\n",
    "        en12_norm = n12_norm*u_norm\n",
    "        en13_norm = n13_norm*u_norm\n",
    "        en14_norm = n14_norm*u_norm\n",
    "        en15_norm = n15_norm*u_norm\n",
    "        en16_norm = n16_norm*u_norm\n",
    "        en17_norm = n17_norm*u_norm\n",
    "        en18_norm = n18_norm*u_norm\n",
    "        en19_norm = n19_norm*u_norm\n",
    "        en20_norm = n20_norm*u_norm\n",
    "        en21_norm = n21_norm*u_norm\n",
    "        en22_norm = n22_norm*u_norm\n",
    "        en23_norm = n23_norm*u_norm\n",
    "        en24_norm = n24_norm*u_norm\n",
    "        en25_norm = n25_norm*u_norm\n",
    "        en26_norm = n26_norm*u_norm\n",
    "        en27_norm = n27_norm*u_norm\n",
    "        en28_norm = n28_norm*u_norm\n",
    "        en29_norm = n29_norm*u_norm\n",
    "        en30_norm = n30_norm*u_norm\n",
    "        en31_norm = n31_norm*u_norm\n",
    "        en32_norm = n32_norm*u_norm\n",
    "        en33_norm = n33_norm*u_norm\n",
    "        en34_norm = n34_norm*u_norm\n",
    "        en35_norm = n35_norm*u_norm\n",
    "        en36_norm = n36_norm*u_norm\n",
    "        en37_norm = n37_norm*u_norm\n",
    "        en38_norm = n38_norm*u_norm\n",
    "        en39_norm = n39_norm*u_norm\n",
    "        en40_norm = n40_norm*u_norm\n",
    "        en41_norm = n41_norm*u_norm\n",
    "        en42_norm = n42_norm*u_norm\n",
    "        en43_norm = n43_norm*u_norm\n",
    "        en44_norm = n44_norm*u_norm\n",
    "        en45_norm = n45_norm*u_norm\n",
    "        en46_norm = n46_norm*u_norm\n",
    "        en47_norm = n47_norm*u_norm\n",
    "        enat_norm = nat_norm*u_norm\n",
    "\n",
    "        # Weight factor... let's see its impact by varying it w = [0:100].\n",
    "        # If is it 0, then PINN -> NN and we do not physically inform the NN.\n",
    "        w = 0.\n",
    "\n",
    "        # Define Cost function or the Loss\n",
    "        # In this case I have set the mean squared error of the ouputs to be\n",
    "        # the loss and commented the PINN residual arguements. Uncommenting the\n",
    "        # 4 residual expressions will result in a true Phyics Informed Neural\n",
    "        # Network, otherwise, it is just a data trained Neural network\n",
    "        self.loss = tf.reduce_sum(tf.square(self.u_tf   - self.u_pred)) /(u_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.rho_tf - self.rho_pred))/(rho_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.p_tf   - self.p_pred)) /(p_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.E_tf   - self.E_pred)) /(E_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n1_tf  - self.n1_pred))/(n1_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n2_tf  - self.n2_pred))/(n2_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n3_tf  - self.n3_pred))/(n3_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n4_tf  - self.n4_pred))/(n4_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n5_tf  - self.n5_pred))/(n5_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n6_tf  - self.n6_pred))/(n6_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n7_tf  - self.n7_pred))/(n7_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n8_tf  - self.n8_pred))/(n8_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n9_tf  - self.n9_pred))/(n9_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n10_tf - self.n10_pred))/(n10_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n11_tf - self.n11_pred))/(n11_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n12_tf - self.n12_pred))/(n12_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n13_tf - self.n13_pred))/(n13_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n14_tf - self.n14_pred))/(n14_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n15_tf - self.n15_pred))/(n15_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n16_tf - self.n16_pred))/(n16_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n17_tf - self.n17_pred))/(n17_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n18_tf - self.n18_pred))/(n18_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n19_tf - self.n19_pred))/(n19_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n20_tf - self.n20_pred))/(n20_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n21_tf - self.n21_pred))/(n21_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n22_tf - self.n22_pred))/(n22_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n23_tf - self.n23_pred))/(n23_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n24_tf - self.n24_pred))/(n24_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n25_tf - self.n25_pred))/(n25_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n26_tf - self.n26_pred))/(n26_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n27_tf - self.n27_pred))/(n27_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n28_tf - self.n28_pred))/(n28_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n29_tf - self.n29_pred))/(n29_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n30_tf - self.n30_pred))/(n30_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n31_tf - self.n31_pred))/(n31_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n32_tf - self.n32_pred))/(n32_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n33_tf - self.n33_pred))/(n33_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n34_tf - self.n34_pred))/(n34_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n35_tf - self.n35_pred))/(n35_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n36_tf - self.n36_pred))/(n36_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n37_tf - self.n37_pred))/(n37_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n38_tf - self.n38_pred))/(n38_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n39_tf - self.n39_pred))/(n39_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n40_tf - self.n40_pred))/(n40_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n41_tf - self.n41_pred))/(n41_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n42_tf - self.n42_pred))/(n42_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n43_tf - self.n43_pred))/(n43_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n44_tf - self.n44_pred))/(n44_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n45_tf - self.n45_pred))/(n45_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n46_tf - self.n46_pred))/(n46_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.n47_tf - self.n47_pred))/(n47_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.nat_tf - self.nat_pred))/(nat_norm**2) + \\\n",
    "                    tf.reduce_sum(tf.square(self.R1_tf  - self.R1_pred))/(R1_norm**2) + \\                                           \n",
    "                    tf.reduce_sum(tf.square(self.R2_tf  - self.R2_pred))/(R2_norm**2) + \\                                           \n",
    "                    tf.reduce_sum(tf.square(self.R3_tf  - self.R3_pred))/(R3_norm**2) + \\                                           \n",
    "                    tf.reduce_sum(tf.square(self.R4_tf  - self.R4_pred))/(R4_norm**2) + \\                                           \n",
    "                    tf.reduce_sum(tf.square(self.R5_tf  - self.R5_pred))/(R5_norm**2) + \\                                           \n",
    "                    tf.reduce_sum(tf.square(self.R6_tf  - self.R6_pred))/(R6_norm**2) + \\                                           \n",
    "                    tf.reduce_sum(tf.square(self.R7_tf  - self.R7_pred))/(R7_norm**2) + \\                                           \n",
    "                    tf.reduce_sum(tf.square(self.R8_tf  - self.R8_pred))/(R8_norm**2) + \\                                           \n",
    "                    tf.reduce_sum(tf.square(self.R9_tf  - self.R9_pred))/(R9_norm**2) + \\                                           \n",
    "                    tf.reduce_sum(tf.square(self.R10_tf - self.R10_pred))/(R10_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R11_tf - self.R11_pred))/(R11_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R12_tf - self.R12_pred))/(R12_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R13_tf - self.R13_pred))/(R13_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R14_tf - self.R14_pred))/(R14_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R15_tf - self.R15_pred))/(R15_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R16_tf - self.R16_pred))/(R16_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R17_tf - self.R17_pred))/(R17_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R18_tf - self.R18_pred))/(R18_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R19_tf - self.R19_pred))/(R19_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R20_tf - self.R20_pred))/(R20_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R21_tf - self.R21_pred))/(R21_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R22_tf - self.R22_pred))/(R22_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R23_tf - self.R23_pred))/(R23_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R24_tf - self.R24_pred))/(R24_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R25_tf - self.R25_pred))/(R25_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R26_tf - self.R26_pred))/(R26_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R27_tf - self.R27_pred))/(R27_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R28_tf - self.R28_pred))/(R28_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R29_tf - self.R29_pred))/(R29_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R30_tf - self.R30_pred))/(R30_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R31_tf - self.R31_pred))/(R31_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R32_tf - self.R32_pred))/(R32_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R33_tf - self.R33_pred))/(R33_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R34_tf - self.R34_pred))/(R34_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R35_tf - self.R35_pred))/(R35_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R36_tf - self.R36_pred))/(R36_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R37_tf - self.R37_pred))/(R37_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R38_tf - self.R38_pred))/(R38_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R39_tf - self.R39_pred))/(R39_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R40_tf - self.R40_pred))/(R40_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R41_tf - self.R41_pred))/(R41_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R42_tf - self.R42_pred))/(R42_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R43_tf - self.R43_pred))/(R43_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R44_tf - self.R44_pred))/(R44_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R45_tf - self.R45_pred))/(R45_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R46_tf - self.R46_pred))/(R46_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.R47_tf - self.R47_pred))/(R47_norm**2) + \\                                         \n",
    "                    tf.reduce_sum(tf.square(self.Rat_tf - self.Rat_pred))/(Rat_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.e1))/(e1_norm**2)                    + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.e2))/(e2_norm**2)                    + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.e3))/(e3_norm**2)                    + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.e4))/(p_norm**2)                     + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en1))/(en1_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en2))/(en2_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en3))/(en3_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en4))/(en4_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en5))/(en5_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en6))/(en6_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en7))/(en7_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en8))/(en8_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en9))/(en9_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en10))/(en10_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en11))/(en11_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en12))/(en12_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en13))/(en13_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en14))/(en14_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en15))/(en15_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en16))/(en16_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en17))/(en17_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en18))/(en18_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en19))/(en19_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en20))/(en20_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en21))/(en21_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en22))/(en22_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en23))/(en23_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en24))/(en24_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en25))/(en25_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en26))/(en26_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en27))/(en27_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en28))/(en28_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en29))/(en29_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en30))/(en30_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en31))/(en31_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en32))/(en32_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en33))/(en33_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en34))/(en34_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en35))/(en35_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en36))/(en36_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en37))/(en37_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en38))/(en38_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en39))/(en39_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en40))/(en40_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en41))/(en41_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en42))/(en42_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en43))/(en43_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en44))/(en44_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en45))/(en45_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en46))/(en46_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.en47))/(en47_norm**2) + \\\n",
    "                    w*tf.reduce_sum(tf.square(self.enat))/(enat_norm**2)\n",
    "\n",
    "        # Define optimizers\n",
    "        # There are 2 optimizers used: external by Scipy (L-BFGS-B) and internal\n",
    "        # by Tensorflow (which is Adam). The external optimizer gives an extra\n",
    "        # push after the internal has done its job. No need to change the default\n",
    "        # options of the optimizers. We have used Adam optimizer in this case,\n",
    "        # since, it is the most common and generally the fastest known converger\n",
    "        self.optimizer = tf.contrib.opt.ScipyOptimizerInterface(self.loss,\n",
    "                                                                method = 'L-BFGS-B',\n",
    "                                                                options = {'maxiter': 50000,\n",
    "                                                                           'maxfun': 50000,\n",
    "                                                                           'maxcor': 50,\n",
    "                                                                           'maxls': 50,\n",
    "                                                                           'ftol' : 1.0 * np.finfo(float).eps})\n",
    "        # Adam\n",
    "        self.optimizer_Adam = tf.compat.v1.train.AdamOptimizer()\n",
    "        self.train_op_Adam = self.optimizer_Adam.minimize(self.loss)\n",
    "\n",
    "        # Run the session after variable initialization\n",
    "        init = tf.global_variables_initializer()\n",
    "        self.sess.run(init)\n",
    "\n",
    "    # Class methods\n",
    "\n",
    "    # These are basic initialization functions to create the weigths and biases\n",
    "    # tensor variables and assign random values to start with code snippet\n",
    "    # iterates over the layers vector to generate the tensors as stated\n",
    "    def initialize_NN(self, layers):\n",
    "        weights = []\n",
    "        biases = []\n",
    "        num_layers = len(layers)\n",
    "        for l in range(0,num_layers-1):\n",
    "            W = self.xavier_init(size=[layers[l], layers[l+1]])\n",
    "            b = tf.Variable(tf.zeros([1,layers[l+1]], dtype=tf.float32), dtype=tf.float32)\n",
    "            weights.append(W)\n",
    "            biases.append(b)\n",
    "        return weights, biases\n",
    "\n",
    "    def xavier_init(self, size):\n",
    "        in_dim = size[0]\n",
    "        out_dim = size[1]\n",
    "        xavier_stddev = np.sqrt(2/(in_dim + out_dim))\n",
    "        return tf.Variable(tf.random.truncated_normal([in_dim, out_dim], stddev=xavier_stddev), dtype=tf.float32)\n",
    "\n",
    "    # Code for a single forward propagation pass taking in weights, biases and\n",
    "    # input matrix X. Note the normalization step on X as H before passing on to\n",
    "    # the network\n",
    "    def neural_net(self, X, weights, biases):\n",
    "        num_layers = len(weights) + 1\n",
    "\n",
    "        H = 2.0*(X - self.lb)/(self.ub - self.lb) - 1.0\n",
    "        for l in range(0,num_layers-2):\n",
    "            W = weights[l]\n",
    "            b = biases[l]\n",
    "            H = tf.tanh(tf.add(tf.matmul(H, W), b))\n",
    "        W = weights[-1]\n",
    "        b = biases[-1]\n",
    "        Y = tf.add(tf.matmul(H, W), b)\n",
    "        return Y\n",
    "\n",
    "    # This is the differentiating code snippet which does the Automatic\n",
    "    # Differential method to find the coefficients of the necessary gradients (or\n",
    "    # equivalently, residuals) to be used in the MSE (mean squared error) in the\n",
    "    # cost function. The step is to reference the earlier function neural_net and\n",
    "    # gain the outputs as a matrix. The matrix is then sliced into individual\n",
    "    # components to get pressure, density, speed and specific energy. We define\n",
    "    # the cross section area contour S to be used in the following Physical\n",
    "    # expressions for 1D Nozzle flow. Next we find the residuals by AutoDiff.\n",
    "    # The autodiff function provided by Tensorflow is tf.gradients as above. The\n",
    "    # mass_flow_grad, momentum_grad and energy_grad are actually the residuals of\n",
    "    # the three Compressible Physical expressions. Return all the variables back\n",
    "    # to the class attributes.\n",
    "\n",
    "    def net_Euler_STS(self, x):\n",
    "\n",
    "        nci_rho_u_p_E = self.neural_net(tf.concat([x], 1), self.weights, self.biases)\n",
    "\n",
    "        n1  = nci_rho_u_p_E[:,0:1]\n",
    "        n2  = nci_rho_u_p_E[:,1:2]\n",
    "        n3  = nci_rho_u_p_E[:,2:3]\n",
    "        n4  = nci_rho_u_p_E[:,3:4]\n",
    "        n5  = nci_rho_u_p_E[:,4:5]\n",
    "        n6  = nci_rho_u_p_E[:,5:6]\n",
    "        n7  = nci_rho_u_p_E[:,6:7]\n",
    "        n8  = nci_rho_u_p_E[:,7:8]\n",
    "        n9  = nci_rho_u_p_E[:,8:9]\n",
    "        n10  = nci_rho_u_p_E[:,9:10]\n",
    "        n11  = nci_rho_u_p_E[:,10:11]\n",
    "        n12  = nci_rho_u_p_E[:,11:12]\n",
    "        n13  = nci_rho_u_p_E[:,12:13]\n",
    "        n14  = nci_rho_u_p_E[:,13:14]\n",
    "        n15  = nci_rho_u_p_E[:,14:15]\n",
    "        n16  = nci_rho_u_p_E[:,15:16]\n",
    "        n17  = nci_rho_u_p_E[:,16:17]\n",
    "        n18  = nci_rho_u_p_E[:,17:18]\n",
    "        n19  = nci_rho_u_p_E[:,18:19]\n",
    "        n20  = nci_rho_u_p_E[:,19:20]\n",
    "        n21  = nci_rho_u_p_E[:,20:21]\n",
    "        n22  = nci_rho_u_p_E[:,21:22]\n",
    "        n23  = nci_rho_u_p_E[:,22:23]\n",
    "        n24  = nci_rho_u_p_E[:,23:24]\n",
    "        n25  = nci_rho_u_p_E[:,24:25]\n",
    "        n26  = nci_rho_u_p_E[:,25:26]\n",
    "        n27  = nci_rho_u_p_E[:,26:27]\n",
    "        n28  = nci_rho_u_p_E[:,27:28]\n",
    "        n29  = nci_rho_u_p_E[:,28:29]\n",
    "        n30  = nci_rho_u_p_E[:,29:30]\n",
    "        n31  = nci_rho_u_p_E[:,30:31]\n",
    "        n32  = nci_rho_u_p_E[:,31:32]\n",
    "        n33  = nci_rho_u_p_E[:,32:33]\n",
    "        n34  = nci_rho_u_p_E[:,33:34]\n",
    "        n35  = nci_rho_u_p_E[:,34:35]\n",
    "        n36  = nci_rho_u_p_E[:,35:36]\n",
    "        n37  = nci_rho_u_p_E[:,36:37]\n",
    "        n38  = nci_rho_u_p_E[:,37:38]\n",
    "        n39  = nci_rho_u_p_E[:,38:39]\n",
    "        n40  = nci_rho_u_p_E[:,39:40]\n",
    "        n41  = nci_rho_u_p_E[:,40:41]\n",
    "        n42  = nci_rho_u_p_E[:,41:42]\n",
    "        n43  = nci_rho_u_p_E[:,42:43]\n",
    "        n44  = nci_rho_u_p_E[:,43:44]\n",
    "        n45  = nci_rho_u_p_E[:,44:45]\n",
    "        n46  = nci_rho_u_p_E[:,45:46]\n",
    "        n47  = nci_rho_u_p_E[:,46:47]\n",
    "        nat  = nci_rho_u_p_E[:,47:48]\n",
    "\n",
    "        rho = nci_rho_u_p_E[:,48:49]\n",
    "        u   = nci_rho_u_p_E[:,49:50]\n",
    "        p   = nci_rho_u_p_E[:,50:51]\n",
    "        E   = nci_rho_u_p_E[:,51:52]\n",
    "\n",
    "        R1   = nci_rho_u_p_E[:,52:53]\n",
    "        R2   = nci_rho_u_p_E[:,53:54]\n",
    "        R3   = nci_rho_u_p_E[:,54:55]\n",
    "        R4   = nci_rho_u_p_E[:,55:56]\n",
    "        R5   = nci_rho_u_p_E[:,56:57]\n",
    "        R6   = nci_rho_u_p_E[:,57:58]\n",
    "        R7   = nci_rho_u_p_E[:,58:59]\n",
    "        R8   = nci_rho_u_p_E[:,59:60]\n",
    "        R9   = nci_rho_u_p_E[:,60:61]\n",
    "        R10  = nci_rho_u_p_E[:,61:62]\n",
    "        R11  = nci_rho_u_p_E[:,62:63]\n",
    "        R12  = nci_rho_u_p_E[:,63:64]\n",
    "        R13  = nci_rho_u_p_E[:,64:65]\n",
    "        R14  = nci_rho_u_p_E[:,65:66]\n",
    "        R15  = nci_rho_u_p_E[:,66:67]\n",
    "        R16  = nci_rho_u_p_E[:,67:68]\n",
    "        R17  = nci_rho_u_p_E[:,68:69]\n",
    "        R18  = nci_rho_u_p_E[:,69:70]\n",
    "        R19  = nci_rho_u_p_E[:,70:71]\n",
    "        R20  = nci_rho_u_p_E[:,71:72]\n",
    "        R21  = nci_rho_u_p_E[:,72:73]\n",
    "        R22  = nci_rho_u_p_E[:,73:74]\n",
    "        R23  = nci_rho_u_p_E[:,74:75]\n",
    "        R24  = nci_rho_u_p_E[:,75:76]\n",
    "        R25  = nci_rho_u_p_E[:,76:77]\n",
    "        R26  = nci_rho_u_p_E[:,77:78]\n",
    "        R27  = nci_rho_u_p_E[:,78:79]\n",
    "        R28  = nci_rho_u_p_E[:,79:80]\n",
    "        R29  = nci_rho_u_p_E[:,80:81]\n",
    "        R30  = nci_rho_u_p_E[:,81:82]\n",
    "        R31  = nci_rho_u_p_E[:,82:83]\n",
    "        R32  = nci_rho_u_p_E[:,83:84]\n",
    "        R33  = nci_rho_u_p_E[:,84:85]\n",
    "        R34  = nci_rho_u_p_E[:,85:86]\n",
    "        R35  = nci_rho_u_p_E[:,86:87]\n",
    "        R36  = nci_rho_u_p_E[:,87:88]\n",
    "        R37  = nci_rho_u_p_E[:,88:89]\n",
    "        R38  = nci_rho_u_p_E[:,89:90]\n",
    "        R39  = nci_rho_u_p_E[:,90:91]\n",
    "        R40  = nci_rho_u_p_E[:,91:92]\n",
    "        R41  = nci_rho_u_p_E[:,92:93]\n",
    "        R42  = nci_rho_u_p_E[:,93:94]\n",
    "        R43  = nci_rho_u_p_E[:,94:95]\n",
    "        R44  = nci_rho_u_p_E[:,95:96]\n",
    "        R45  = nci_rho_u_p_E[:,96:97]\n",
    "        R46  = nci_rho_u_p_E[:,97:98]\n",
    "        R47  = nci_rho_u_p_E[:,98:99]\n",
    "        Rat  = nci_rho_u_p_E[:,99:100]\n",
    "\n",
    "        # temporal derivatives\n",
    "        #n1_t   = tf.gradients(n1,   t)[0]\n",
    "        #n2_t   = tf.gradients(n2,   t)[0]\n",
    "        #n3_t   = tf.gradients(n3,   t)[0]\n",
    "        #n4_t   = tf.gradients(n4,   t)[0]\n",
    "        #n5_t   = tf.gradients(n5,   t)[0]\n",
    "        #n6_t   = tf.gradients(n6,   t)[0]\n",
    "        #n7_t   = tf.gradients(n7,   t)[0]\n",
    "        #n8_t   = tf.gradients(n8,   t)[0]\n",
    "        #n9_t   = tf.gradients(n9,   t)[0]\n",
    "        #n10_t   = tf.gradients(n10,   t)[0]\n",
    "        #n11_t   = tf.gradients(n11,   t)[0]\n",
    "        #n12_t   = tf.gradients(n12,   t)[0]\n",
    "        #n13_t   = tf.gradients(n13,   t)[0]\n",
    "        #n14_t   = tf.gradients(n14,   t)[0]\n",
    "        #n15_t   = tf.gradients(n15,   t)[0]\n",
    "        #n16_t   = tf.gradients(n16,   t)[0]\n",
    "        #n17_t   = tf.gradients(n17,   t)[0]\n",
    "        #n18_t   = tf.gradients(n18,   t)[0]\n",
    "        #n19_t   = tf.gradients(n19,   t)[0]\n",
    "        #n20_t   = tf.gradients(n20,   t)[0]\n",
    "        #n21_t   = tf.gradients(n21,   t)[0]\n",
    "        #n22_t   = tf.gradients(n22,   t)[0]\n",
    "        #n23_t   = tf.gradients(n23,   t)[0]\n",
    "        #n24_t   = tf.gradients(n24,   t)[0]\n",
    "        #n25_t   = tf.gradients(n25,   t)[0]\n",
    "        #n26_t   = tf.gradients(n26,   t)[0]\n",
    "        #n27_t   = tf.gradients(n27,   t)[0]\n",
    "        #n28_t   = tf.gradients(n28,   t)[0]\n",
    "        #n29_t   = tf.gradients(n29,   t)[0]\n",
    "        #n30_t   = tf.gradients(n30,   t)[0]\n",
    "        #n31_t   = tf.gradients(n31,   t)[0]\n",
    "        #n32_t   = tf.gradients(n32,   t)[0]\n",
    "        #n33_t   = tf.gradients(n33,   t)[0]\n",
    "        #n34_t   = tf.gradients(n34,   t)[0]\n",
    "        #n35_t   = tf.gradients(n35,   t)[0]\n",
    "        #n36_t   = tf.gradients(n36,   t)[0]\n",
    "        #n37_t   = tf.gradients(n37,   t)[0]\n",
    "        #n38_t   = tf.gradients(n38,   t)[0]\n",
    "        #n39_t   = tf.gradients(n39,   t)[0]\n",
    "        #n40_t   = tf.gradients(n40,   t)[0]\n",
    "        #n41_t   = tf.gradients(n41,   t)[0]\n",
    "        #n42_t   = tf.gradients(n42,   t)[0]\n",
    "        #n43_t   = tf.gradients(n43,   t)[0]\n",
    "        #n44_t   = tf.gradients(n44,   t)[0]\n",
    "        #n45_t   = tf.gradients(n45,   t)[0]\n",
    "        #n46_t   = tf.gradients(n46,   t)[0]\n",
    "        #n47_t   = tf.gradients(n47,   t)[0]\n",
    "        #nat_t   = tf.gradients(nat,   t)[0]\n",
    "\n",
    "        #rho_t   = tf.gradients(rho,   t)[0]\n",
    "        #rho_u_t = tf.gradients(rho*u, t)[0]\n",
    "        #rho_E_t = tf.gradients(rho*E, t)[0]\n",
    "\n",
    "        n1_u_x  = tf.gradients(n1 *u, x)[0]\n",
    "        n2_u_x  = tf.gradients(n2 *u, x)[0]\n",
    "        n3_u_x  = tf.gradients(n3 *u, x)[0]\n",
    "        n4_u_x  = tf.gradients(n4 *u, x)[0]\n",
    "        n5_u_x  = tf.gradients(n5 *u, x)[0]\n",
    "        n6_u_x  = tf.gradients(n6 *u, x)[0]\n",
    "        n7_u_x  = tf.gradients(n7 *u, x)[0]\n",
    "        n8_u_x  = tf.gradients(n8 *u, x)[0]\n",
    "        n9_u_x  = tf.gradients(n9 *u, x)[0]\n",
    "        n10_u_x = tf.gradients(n10*u, x)[0]\n",
    "        n11_u_x = tf.gradients(n11*u, x)[0]\n",
    "        n12_u_x = tf.gradients(n12*u, x)[0]\n",
    "        n13_u_x = tf.gradients(n13*u, x)[0]\n",
    "        n14_u_x = tf.gradients(n14*u, x)[0]\n",
    "        n15_u_x = tf.gradients(n15*u, x)[0]\n",
    "        n16_u_x = tf.gradients(n16*u, x)[0]\n",
    "        n17_u_x = tf.gradients(n17*u, x)[0]\n",
    "        n18_u_x = tf.gradients(n18*u, x)[0]\n",
    "        n19_u_x = tf.gradients(n19*u, x)[0]\n",
    "        n20_u_x = tf.gradients(n20*u, x)[0]\n",
    "        n21_u_x = tf.gradients(n21*u, x)[0]\n",
    "        n22_u_x = tf.gradients(n22*u, x)[0]\n",
    "        n23_u_x = tf.gradients(n23*u, x)[0]\n",
    "        n24_u_x = tf.gradients(n24*u, x)[0]\n",
    "        n25_u_x = tf.gradients(n25*u, x)[0]\n",
    "        n26_u_x = tf.gradients(n26*u, x)[0]\n",
    "        n27_u_x = tf.gradients(n27*u, x)[0]\n",
    "        n28_u_x = tf.gradients(n28*u, x)[0]\n",
    "        n29_u_x = tf.gradients(n29*u, x)[0]\n",
    "        n30_u_x = tf.gradients(n30*u, x)[0]\n",
    "        n31_u_x = tf.gradients(n31*u, x)[0]\n",
    "        n32_u_x = tf.gradients(n32*u, x)[0]\n",
    "        n33_u_x = tf.gradients(n33*u, x)[0]\n",
    "        n34_u_x = tf.gradients(n34*u, x)[0]\n",
    "        n35_u_x = tf.gradients(n35*u, x)[0]\n",
    "        n36_u_x = tf.gradients(n36*u, x)[0]\n",
    "        n37_u_x = tf.gradients(n37*u, x)[0]\n",
    "        n38_u_x = tf.gradients(n38*u, x)[0]\n",
    "        n39_u_x = tf.gradients(n39*u, x)[0]\n",
    "        n40_u_x = tf.gradients(n40*u, x)[0]\n",
    "        n41_u_x = tf.gradients(n41*u, x)[0]\n",
    "        n42_u_x = tf.gradients(n42*u, x)[0]\n",
    "        n43_u_x = tf.gradients(n43*u, x)[0]\n",
    "        n44_u_x = tf.gradients(n44*u, x)[0]\n",
    "        n45_u_x = tf.gradients(n45*u, x)[0]\n",
    "        n46_u_x = tf.gradients(n46*u, x)[0]\n",
    "        n47_u_x = tf.gradients(n47*u, x)[0]\n",
    "        nat_u_x = tf.gradients(nat*u, x)[0]\n",
    "\n",
    "        # autodiff gradient #1\n",
    "        mass_flow_grad = tf.gradients(rho*u, x)[0]\n",
    "\n",
    "        # autodiff gradient #2\n",
    "        momentum_grad = tf.gradients((rho*u*u + p), x)[0]\n",
    "\n",
    "        # autodiff gradient #3\n",
    "        energy_grad = tf.gradients((rho*E + p)*u, x)[0]\n",
    "\n",
    "        # state residual\n",
    "        gamma = 1.4\n",
    "        state_res = p - rho*(gamma-1.0)*(E-0.5*gamma*u*u)\n",
    "\n",
    "        eqn1  =  n1_u_x  - R1\n",
    "        eqn2  =  n2_u_x  - R2\n",
    "        eqn3  =  n3_u_x  - R3\n",
    "        eqn4  =  n4_u_x  - R4\n",
    "        eqn5  =  n5_u_x  - R5\n",
    "        eqn6  =  n6_u_x  - R6\n",
    "        eqn7  =  n7_u_x  - R7\n",
    "        eqn8  =  n8_u_x  - R8\n",
    "        eqn9  =  n9_u_x  - R9\n",
    "        eqn10 =  n10_u_x - R10\n",
    "        eqn11 =  n11_u_x - R11\n",
    "        eqn12 =  n12_u_x - R12\n",
    "        eqn13 =  n13_u_x - R13\n",
    "        eqn14 =  n14_u_x - R14\n",
    "        eqn15 =  n15_u_x - R15\n",
    "        eqn16 =  n16_u_x - R16\n",
    "        eqn17 =  n17_u_x - R17\n",
    "        eqn18 =  n18_u_x - R18\n",
    "        eqn19 =  n19_u_x - R19\n",
    "        eqn20 =  n20_u_x - R20\n",
    "        eqn21 =  n21_u_x - R21\n",
    "        eqn22 =  n22_u_x - R22\n",
    "        eqn23 =  n23_u_x - R23\n",
    "        eqn24 =  n24_u_x - R24\n",
    "        eqn25 =  n25_u_x - R25\n",
    "        eqn26 =  n26_u_x - R26\n",
    "        eqn27 =  n27_u_x - R27\n",
    "        eqn28 =  n28_u_x - R28\n",
    "        eqn29 =  n29_u_x - R29\n",
    "        eqn30 =  n30_u_x - R30\n",
    "        eqn31 =  n31_u_x - R31\n",
    "        eqn32 =  n32_u_x - R32\n",
    "        eqn33 =  n33_u_x - R33\n",
    "        eqn34 =  n34_u_x - R34\n",
    "        eqn35 =  n35_u_x - R35\n",
    "        eqn36 =  n36_u_x - R36\n",
    "        eqn37 =  n37_u_x - R37\n",
    "        eqn38 =  n38_u_x - R38\n",
    "        eqn39 =  n39_u_x - R39\n",
    "        eqn40 =  n40_u_x - R40\n",
    "        eqn41 =  n41_u_x - R41\n",
    "        eqn42 =  n42_u_x - R42\n",
    "        eqn43 =  n43_u_x - R43\n",
    "        eqn44 =  n44_u_x - R44\n",
    "        eqn45 =  n45_u_x - R45\n",
    "        eqn46 =  n46_u_x - R46\n",
    "        eqn47 =  n47_u_x - R47\n",
    "        eqnat =  nat_u_x - Rat\n",
    "\n",
    "        eq1 =  mass_flow_grad\n",
    "        eq2 =  momentum_grad\n",
    "        eq3 =  energy_grad\n",
    "        eq4 =  state_res\n",
    "\n",
    "        return n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12, n13, n14, n15, n16, n17, n18, n19, \\\n",
    "               n20, n21, n22, n23, n24, n25, n26, n27, n28, n29, n30, n31, n32, n33, n34, n35, n36, n37, n38, n39, \\\n",
    "               n40, n41, n42, n43, n44, n45, n46, n47, nat, \\\n",
    "               rho, u, p, E, \\\n",
    "               R1, R2, R3, R4, R5, R6, R7, R8, R9, R10, \\\n",
    "               R11, R12, R13, R14, R15, R16, R17, R18, R19, R20, R21, R22, R23, R24, R25, R26, R27, R28, R29, R30, \\\n",
    "               R31, R32, R33, R34, R35, R36, R37, R38, R39, R40, R41, R42, R43, R44, R45, R46, R47, Rat, \\\n",
    "               eq1, eq2, eq3, eq4, eqn1, eqn2, eqn3, eqn4, eqn5, eqn6, eqn7, eqn8, eqn9, eqn10, eqn11, eqn12, eqn13, eqn14, \\\n",
    "               eqn15, eqn16, eqn17, eqn18, eqn19, eqn20, eqn21, eqn22, eqn23, eqn24, eqn25, eqn26, eqn27, eqn28, \\\n",
    "               eqn29, eqn30, eqn31, eqn32, eqn33, eqn34, eqn35, eqn36, eqn37, eqn38, eqn39, eqn40, eqn41, eqn42, \\\n",
    "               eqn43, eqn44, eqn45, eqn46, eqn47, eqnat\n",
    "\n",
    "    # callback method just prints the current loss (cost) value of the network.\n",
    "    def callback(self, loss):\n",
    "        print('Loss: %.3e' % (loss))\n",
    "\n",
    "    # Train method actually trains the network weights based on the target\n",
    "    # of minimizing the loss. tf_dict is defined as the set of input and\n",
    "    # ideal output parameters for the given data in loop. For the given\n",
    "    # iterations 'nIter' (variable), the train_op_Adam session is run.\n",
    "    def train(self, nIter):\n",
    "\n",
    "        tf_dict = {self.x_tf:   self.x,\n",
    "                   self.n1_tf:  self.n1,  self.n2_tf:  self.n2,  self.n3_tf:  self.n3,  self.n4_tf:  self.n4,\n",
    "                   self.n5_tf:  self.n5,  self.n6_tf:  self.n6,  self.n7_tf:  self.n7,  self.n8_tf:  self.n8,\n",
    "                   self.n9_tf:  self.n9,  self.n10_tf: self.n10, self.n11_tf: self.n11, self.n12_tf: self.n12,\n",
    "                   self.n13_tf: self.n13, self.n14_tf: self.n14, self.n15_tf: self.n15, self.n16_tf: self.n16,\n",
    "                   self.n17_tf: self.n17, self.n18_tf: self.n18, self.n19_tf: self.n19, self.n20_tf: self.n20,\n",
    "                   self.n21_tf: self.n21, self.n22_tf: self.n22, self.n23_tf: self.n23, self.n24_tf: self.n24,\n",
    "                   self.n25_tf: self.n25, self.n26_tf: self.n26, self.n27_tf: self.n27, self.n28_tf: self.n28,\n",
    "                   self.n29_tf: self.n29, self.n30_tf: self.n30, self.n31_tf: self.n31, self.n32_tf: self.n32,\n",
    "                   self.n33_tf: self.n33, self.n34_tf: self.n34, self.n35_tf: self.n35, self.n36_tf: self.n36,\n",
    "                   self.n37_tf: self.n37, self.n38_tf: self.n38, self.n39_tf: self.n39, self.n40_tf: self.n40,\n",
    "                   self.n41_tf: self.n41, self.n42_tf: self.n42, self.n43_tf: self.n43, self.n44_tf: self.n44,\n",
    "                   self.n45_tf: self.n45, self.n46_tf: self.n46, self.n47_tf: self.n47, self.nat_tf: self.nat,\n",
    "                   self.rho_tf: self.rho, self.u_tf:   self.u,   self.p_tf:   self.p,   self.E_tf:   self.E,\n",
    "                   self.R1_tf:  self.R1,  self.R2_tf:  self.R2,  self.R3_tf:  self.R3,  self.R4_tf:  self.R4,\n",
    "                   self.R5_tf:  self.R5,  self.R6_tf:  self.R6,  self.R7_tf:  self.R7,  self.R8_tf:  self.R8,\n",
    "                   self.R9_tf:  self.R9,  self.R10_tf: self.n10, self.R11_tf: self.R11, self.R12_tf: self.R12,\n",
    "                   self.R13_tf: self.R13, self.R14_tf: self.R14, self.R15_tf: self.R15, self.R16_tf: self.R16,\n",
    "                   self.R17_tf: self.R17, self.R18_tf: self.R18, self.R19_tf: self.R19, self.R20_tf: self.R20,\n",
    "                   self.R21_tf: self.R21, self.R22_tf: self.R22, self.R23_tf: self.R23, self.R24_tf: self.R24,\n",
    "                   self.R25_tf: self.R25, self.R26_tf: self.R26, self.R27_tf: self.R27, self.R28_tf: self.R28,\n",
    "                   self.R29_tf: self.R29, self.R30_tf: self.R30, self.R31_tf: self.R31, self.R32_tf: self.R32,\n",
    "                   self.R33_tf: self.R33, self.R34_tf: self.R34, self.R35_tf: self.R35, self.R36_tf: self.R36,\n",
    "                   self.R37_tf: self.R37, self.R38_tf: self.R38, self.R39_tf: self.R39, self.R40_tf: self.R40,\n",
    "                   self.R41_tf: self.R41, self.R42_tf: self.R42, self.R43_tf: self.R43, self.R44_tf: self.R44,\n",
    "                   self.R45_tf: self.R45, self.R46_tf: self.R46, self.R47_tf: self.R47, self.Rat_tf: self.Rat}\n",
    "\n",
    "        global loss_vector\n",
    "        loss_vector = []\n",
    "\n",
    "        start_time = time.time()\n",
    "        for it in range(nIter):\n",
    "            self.sess.run(self.train_op_Adam, tf_dict)\n",
    "\n",
    "            loss_value = self.sess.run(self.loss, tf_dict)\n",
    "            loss_vector.append(loss_value)\n",
    "\n",
    "            # Print\n",
    "            if it % 100 == 0:\n",
    "                elapsed = time.time() - start_time\n",
    "                loss_value = self.sess.run(self.loss, tf_dict)\n",
    "                #res1 = self.sess.run(self.e1, tf_dict)\n",
    "                #res2 = self.sess.run(self.e2, tf_dict)\n",
    "                #res3 = self.sess.run(self.e3, tf_dict)\n",
    "\n",
    "                print('Iter: %d, Loss: %.3e, Time: %.2f' %\n",
    "                      (it, loss_value, elapsed))\n",
    "                #print('Mass Residual: %f\\t\\tMomentum Residual: %f\\tEnergy Residual: %f'\n",
    "                #    %(sum(map(lambda a:a*a,res1))/len(res1), sum(map(lambda a:a*a,res2))/len(res2), sum(map(lambda a:a*a,res3))/len(res3)))\n",
    "                start_time = time.time()\n",
    "\n",
    "        # The following is external optimizer.\n",
    "        # Uncomment it to see in action. It runs indefinitely till\n",
    "        # convergence. Even after the iterations are finished, the optimizer\n",
    "        # continues to minimize the loss as compelled to by the statement\n",
    "        # self.optimizer.minimize, passing tf_dict to the loss expression defined\n",
    "        # as an attribute earlier in the class.\n",
    "        self.optimizer.minimize(self.sess,\n",
    "                feed_dict = tf_dict,\n",
    "                fetches = [self.loss],\n",
    "                loss_callback = self.callback)\n",
    "\n",
    "        return loss_vector\n",
    "\n",
    "    # Predict method is used to predict the output values when test data is\n",
    "    # passed into the netowrk after the training is completed. All the values are\n",
    "    # returned to the call\n",
    "    def predict(self, x_test):\n",
    "\n",
    "        tf_dict  = {self.x_tf: x_test}\n",
    "\n",
    "        n1_test  = self.sess.run(self.n1_pred,  tf_dict)\n",
    "        n2_test  = self.sess.run(self.n2_pred,  tf_dict)\n",
    "        n3_test  = self.sess.run(self.n3_pred,  tf_dict)\n",
    "        n4_test  = self.sess.run(self.n4_pred,  tf_dict)\n",
    "        n5_test  = self.sess.run(self.n5_pred,  tf_dict)\n",
    "        n6_test  = self.sess.run(self.n6_pred,  tf_dict)\n",
    "        n7_test  = self.sess.run(self.n7_pred,  tf_dict)\n",
    "        n8_test  = self.sess.run(self.n8_pred,  tf_dict)\n",
    "        n9_test  = self.sess.run(self.n9_pred,  tf_dict)\n",
    "        n10_test = self.sess.run(self.n10_pred, tf_dict)\n",
    "        n11_test = self.sess.run(self.n11_pred, tf_dict)\n",
    "        n12_test = self.sess.run(self.n12_pred, tf_dict)\n",
    "        n13_test = self.sess.run(self.n13_pred, tf_dict)\n",
    "        n14_test = self.sess.run(self.n14_pred, tf_dict)\n",
    "        n15_test = self.sess.run(self.n15_pred, tf_dict)\n",
    "        n16_test = self.sess.run(self.n16_pred, tf_dict)\n",
    "        n17_test = self.sess.run(self.n17_pred, tf_dict)\n",
    "        n18_test = self.sess.run(self.n18_pred, tf_dict)\n",
    "        n19_test = self.sess.run(self.n19_pred, tf_dict)\n",
    "        n20_test = self.sess.run(self.n20_pred, tf_dict)\n",
    "        n21_test = self.sess.run(self.n21_pred, tf_dict)\n",
    "        n22_test = self.sess.run(self.n22_pred, tf_dict)\n",
    "        n23_test = self.sess.run(self.n23_pred, tf_dict)\n",
    "        n24_test = self.sess.run(self.n24_pred, tf_dict)\n",
    "        n25_test = self.sess.run(self.n25_pred, tf_dict)\n",
    "        n26_test = self.sess.run(self.n26_pred, tf_dict)\n",
    "        n27_test = self.sess.run(self.n27_pred, tf_dict)\n",
    "        n28_test = self.sess.run(self.n28_pred, tf_dict)\n",
    "        n29_test = self.sess.run(self.n29_pred, tf_dict)\n",
    "        n30_test = self.sess.run(self.n30_pred, tf_dict)\n",
    "        n31_test = self.sess.run(self.n31_pred, tf_dict)\n",
    "        n32_test = self.sess.run(self.n32_pred, tf_dict)\n",
    "        n33_test = self.sess.run(self.n33_pred, tf_dict)\n",
    "        n34_test = self.sess.run(self.n34_pred, tf_dict)\n",
    "        n35_test = self.sess.run(self.n35_pred, tf_dict)\n",
    "        n36_test = self.sess.run(self.n36_pred, tf_dict)\n",
    "        n37_test = self.sess.run(self.n37_pred, tf_dict)\n",
    "        n38_test = self.sess.run(self.n38_pred, tf_dict)\n",
    "        n39_test = self.sess.run(self.n39_pred, tf_dict)\n",
    "        n40_test = self.sess.run(self.n40_pred, tf_dict)\n",
    "        n41_test = self.sess.run(self.n41_pred, tf_dict)\n",
    "        n42_test = self.sess.run(self.n42_pred, tf_dict)\n",
    "        n43_test = self.sess.run(self.n43_pred, tf_dict)\n",
    "        n44_test = self.sess.run(self.n44_pred, tf_dict)\n",
    "        n45_test = self.sess.run(self.n45_pred, tf_dict)\n",
    "        n46_test = self.sess.run(self.n46_pred, tf_dict)\n",
    "        n47_test = self.sess.run(self.n47_pred, tf_dict)\n",
    "        nat_test = self.sess.run(self.nat_pred, tf_dict)\n",
    "\n",
    "        rho_test = self.sess.run(self.rho_pred, tf_dict)\n",
    "        u_test   = self.sess.run(self.u_pred,   tf_dict)\n",
    "        p_test   = self.sess.run(self.p_pred,   tf_dict)\n",
    "        E_test   = self.sess.run(self.E_pred,   tf_dict)\n",
    "\n",
    "        R1_test  = self.sess.run(self.R1_pred,  tf_dict)\n",
    "        R2_test  = self.sess.run(self.R2_pred,  tf_dict)\n",
    "        R3_test  = self.sess.run(self.R3_pred,  tf_dict)\n",
    "        R4_test  = self.sess.run(self.R4_pred,  tf_dict)\n",
    "        R5_test  = self.sess.run(self.R5_pred,  tf_dict)\n",
    "        R6_test  = self.sess.run(self.R6_pred,  tf_dict)\n",
    "        R7_test  = self.sess.run(self.R7_pred,  tf_dict)\n",
    "        R8_test  = self.sess.run(self.R8_pred,  tf_dict)\n",
    "        R9_test  = self.sess.run(self.R9_pred,  tf_dict)\n",
    "        R10_test = self.sess.run(self.R10_pred, tf_dict)\n",
    "        R11_test = self.sess.run(self.R11_pred, tf_dict)\n",
    "        R12_test = self.sess.run(self.R12_pred, tf_dict)\n",
    "        R13_test = self.sess.run(self.R13_pred, tf_dict)\n",
    "        R14_test = self.sess.run(self.R14_pred, tf_dict)\n",
    "        R15_test = self.sess.run(self.R15_pred, tf_dict)\n",
    "        R16_test = self.sess.run(self.R16_pred, tf_dict)\n",
    "        R17_test = self.sess.run(self.R17_pred, tf_dict)\n",
    "        R18_test = self.sess.run(self.R18_pred, tf_dict)\n",
    "        R19_test = self.sess.run(self.R19_pred, tf_dict)\n",
    "        R20_test = self.sess.run(self.R20_pred, tf_dict)\n",
    "        R21_test = self.sess.run(self.R21_pred, tf_dict)\n",
    "        R22_test = self.sess.run(self.R22_pred, tf_dict)\n",
    "        R23_test = self.sess.run(self.R23_pred, tf_dict)\n",
    "        R24_test = self.sess.run(self.R24_pred, tf_dict)\n",
    "        R25_test = self.sess.run(self.R25_pred, tf_dict)\n",
    "        R26_test = self.sess.run(self.R26_pred, tf_dict)\n",
    "        R27_test = self.sess.run(self.R27_pred, tf_dict)\n",
    "        R28_test = self.sess.run(self.R28_pred, tf_dict)\n",
    "        R29_test = self.sess.run(self.R29_pred, tf_dict)\n",
    "        R30_test = self.sess.run(self.R30_pred, tf_dict)\n",
    "        R31_test = self.sess.run(self.R31_pred, tf_dict)\n",
    "        R32_test = self.sess.run(self.R32_pred, tf_dict)\n",
    "        R33_test = self.sess.run(self.R33_pred, tf_dict)\n",
    "        R34_test = self.sess.run(self.R34_pred, tf_dict)\n",
    "        R35_test = self.sess.run(self.R35_pred, tf_dict)\n",
    "        R36_test = self.sess.run(self.R36_pred, tf_dict)\n",
    "        R37_test = self.sess.run(self.R37_pred, tf_dict)\n",
    "        R38_test = self.sess.run(self.R38_pred, tf_dict)\n",
    "        R39_test = self.sess.run(self.R39_pred, tf_dict)\n",
    "        R40_test = self.sess.run(self.R40_pred, tf_dict)\n",
    "        R41_test = self.sess.run(self.R41_pred, tf_dict)\n",
    "        R42_test = self.sess.run(self.R42_pred, tf_dict)\n",
    "        R43_test = self.sess.run(self.R43_pred, tf_dict)\n",
    "        R44_test = self.sess.run(self.R44_pred, tf_dict)\n",
    "        R45_test = self.sess.run(self.R45_pred, tf_dict)\n",
    "        R46_test = self.sess.run(self.R46_pred, tf_dict)\n",
    "        R47_test = self.sess.run(self.R47_pred, tf_dict)\n",
    "        Rat_test = self.sess.run(self.Rat_pred, tf_dict)\n",
    "\n",
    "        return n1_test, n2_test, n3_test, n4_test, n5_test, n6_test, n7_test, n8_test, n9_test, \\\n",
    "               n10_test, n11_test, n12_test, n13_test, n14_test, n15_test, n16_test, n17_test, n18_test, \\\n",
    "               n19_test, n20_test, n21_test, n22_test, n23_test, n24_test, n25_test, n26_test, n27_test, \\\n",
    "               n28_test, n29_test, n30_test, n31_test, n32_test, n33_test, n34_test, n35_test, n36_test, \\\n",
    "               n37_test, n38_test, n39_test, n40_test, n41_test, n42_test, n43_test, n44_test, n45_test, \\\n",
    "               n46_test, n47_test, nat_test, rho_test, u_test, p_test, E_test, R1_test, R2_test, R3_test,\\\n",
    "               R4_test, R5_test, R6_test, R7_test, R8_test, R9_test, R10_test, R11_test, R12_test, \\\n",
    "               R13_test, R14_test, R15_test, R16_test, R17_test, R18_test, R19_test, R20_test, R21_test, \\\n",
    "               R22_test, R23_test, R24_test, R25_test, R26_test, R27_test, R28_test, R29_test, R30_test, \\\n",
    "               R31_test, R32_test, R33_test, R34_test, R35_test, R36_test, R37_test, R38_test, R39_test, \\\n",
    "               R40_test, R41_test, R42_test, R43_test, R44_test, R45_test, R46_test, R47_test, Rat_test\n",
    "\n",
    "def plot_solution(X_star, u_star, index):\n",
    "\n",
    "    lb = X_star.min(0)\n",
    "    ub = X_star.max(0)\n",
    "\n",
    "    nn = 500\n",
    "\n",
    "    x = np.linspace(lb[0], ub[0], nn)\n",
    "    t = np.linspace(lb[1], ub[1], nn)\n",
    "    X, T = np.meshgrid(x,t)\n",
    "\n",
    "    U_star = griddata(X_star, u_star.flatten(), (X, T), method='cubic')\n",
    "\n",
    "    plt.figure(index)\n",
    "    plt.pcolor(X,T,U_star, cmap = 'jet')\n",
    "    plt.colorbar()\n",
    "    plt.show()\n",
    "\n",
    "# The class PINN is initialized by using the standard init function from object\n",
    "# oriented python. There are a total of 7 variables fed to initialize:\n",
    "#\n",
    "# Inputs:\n",
    "# x (distance from the shock or through the 1D nozzle length)\n",
    "# t (time)\n",
    "#\n",
    "# Outputs:\n",
    "# rho (density at x,t),\n",
    "# u (speed at x,t),\n",
    "# p (pressure at x,t),\n",
    "# E (specific energy at x,t),\n",
    "# layers (layers vector).\n",
    "#\n",
    "# We are providing x and t as inputs to the NN and output is P, rho, u, E\n",
    "#\n",
    "# X is the net input matrix which is formed by concatenating x and t for the\n",
    "# training data point. Additional '1' is concatenated for incorporating bias terms.\n",
    "#\n",
    "# lb and ub are the lower and upper bound respectively of X which would be later\n",
    "# used to normalize the value of X before passing it onto the neural network.\n",
    "# This is done to avoid explosion of network output values due to large training\n",
    "# data values of X.\n",
    "\n",
    "# Main function, inside which there are the training and testing commands.\n",
    "if __name__ == \"__main__\":\n",
    "\n",
    "    # Neural Network Architecture\n",
    "    # layers is a vector of all the node in each of the neural network layers\n",
    "    # First value, 1 respresents the input layer with 1 parameter (x) while\n",
    "    # last value 100 is the number of outputs desired\n",
    "    ###layers = [1, 10, 25, 15, 100]\n",
    "    #layers = [1, 20, 20, 20, 20, 20, 20, 20, 20, 20, 100]\n",
    "    #layers = [1, 40, 40, 40, 40, 100]\n",
    "    #layers = [1, 10, 25, 15, 100]                                                                                                   \n",
    "    #layers = [1, 20, 20, 20, 20, 20, 20, 20, 20, 20, 100]                                                                          \n",
    "    #layers = [1, 40, 40, 40, 40, 100]                                                                                              \n",
    "    #layers = [1, 10, 10, 10, 100]                                                                                                  \n",
    "    layers = [1, 15, 25, 25, 15, 100]                                                                                              \n",
    "    #layers = [1, 10,10,10,10,10,10,10, 100]  \n",
    "    \n",
    "    # Load Data\n",
    "    # The Matlab generated data was stored in file name 'dataset_STS.txt', which\n",
    "    # is read by numpy and stored as a new variable by name data.\n",
    "    data = np.loadtxt('data/dataset_STS.txt')\n",
    "\n",
    "    # The training set length N_train is taken to be 85% of the entire dataset.\n",
    "    train_frac = 0.1 #0.75\n",
    "    N_train = int(train_frac*data.shape[0])\n",
    "\n",
    "    # idx is a random numbers vector, which will be used to randomly pick 85% of\n",
    "    # the data from the dataset.\n",
    "    idx = np.random.choice(range(data.shape[0]), size=(N_train,), replace=False)\n",
    "\n",
    "    # The rest is mere slicing of dataset to get all required parameters.\n",
    "\n",
    "    x   = data[:,0:1].flatten()[:,None]\n",
    "    n1  = data[:,1:2].flatten()[:,None]\n",
    "    n2  = data[:,2:3].flatten()[:,None]\n",
    "    n3  = data[:,3:4].flatten()[:,None]\n",
    "    n4  = data[:,4:5].flatten()[:,None]\n",
    "    n5  = data[:,5:6].flatten()[:,None]\n",
    "    n6  = data[:,6:7].flatten()[:,None]\n",
    "    n7  = data[:,7:8].flatten()[:,None]\n",
    "    n8  = data[:,8:9].flatten()[:,None]\n",
    "    n9  = data[:,9:10].flatten()[:,None]\n",
    "    n10 = data[:,10:11].flatten()[:,None]\n",
    "    n11 = data[:,11:12].flatten()[:,None]\n",
    "    n12 = data[:,12:13].flatten()[:,None]\n",
    "    n13 = data[:,13:14].flatten()[:,None]\n",
    "    n14 = data[:,14:15].flatten()[:,None]\n",
    "    n15 = data[:,15:16].flatten()[:,None]\n",
    "    n16 = data[:,16:17].flatten()[:,None]\n",
    "    n17 = data[:,17:18].flatten()[:,None]\n",
    "    n18 = data[:,18:19].flatten()[:,None]\n",
    "    n19 = data[:,19:20].flatten()[:,None]\n",
    "    n20 = data[:,20:21].flatten()[:,None]\n",
    "    n21 = data[:,21:22].flatten()[:,None]\n",
    "    n22 = data[:,22:23].flatten()[:,None]\n",
    "    n23 = data[:,23:24].flatten()[:,None]\n",
    "    n24 = data[:,24:25].flatten()[:,None]\n",
    "    n25 = data[:,25:26].flatten()[:,None]\n",
    "    n26 = data[:,26:27].flatten()[:,None]\n",
    "    n27 = data[:,27:28].flatten()[:,None]\n",
    "    n28 = data[:,28:29].flatten()[:,None]\n",
    "    n29 = data[:,29:30].flatten()[:,None]\n",
    "    n30 = data[:,30:31].flatten()[:,None]\n",
    "    n31 = data[:,31:32].flatten()[:,None]\n",
    "    n32 = data[:,32:33].flatten()[:,None]\n",
    "    n33 = data[:,33:34].flatten()[:,None]\n",
    "    n34 = data[:,34:35].flatten()[:,None]\n",
    "    n35 = data[:,35:36].flatten()[:,None]\n",
    "    n36 = data[:,36:37].flatten()[:,None]\n",
    "    n37 = data[:,37:38].flatten()[:,None]\n",
    "    n38 = data[:,38:39].flatten()[:,None]\n",
    "    n39 = data[:,39:40].flatten()[:,None]\n",
    "    n40 = data[:,40:41].flatten()[:,None]\n",
    "    n41 = data[:,41:42].flatten()[:,None]\n",
    "    n42 = data[:,42:43].flatten()[:,None]\n",
    "    n43 = data[:,43:44].flatten()[:,None]\n",
    "    n44 = data[:,44:45].flatten()[:,None]\n",
    "    n45 = data[:,45:46].flatten()[:,None]\n",
    "    n46 = data[:,46:47].flatten()[:,None]\n",
    "    n47 = data[:,47:48].flatten()[:,None]\n",
    "    nat = data[:,48:49].flatten()[:,None]\n",
    "\n",
    "    rho = data[:,49:50].flatten()[:,None]\n",
    "    u   = data[:,50:51].flatten()[:,None]\n",
    "    p   = data[:,51:52].flatten()[:,None]\n",
    "    E   = data[:,52:53].flatten()[:,None]\n",
    "\n",
    "    R1  = data[:,53:54].flatten()[:,None]\n",
    "    R2  = data[:,54:55].flatten()[:,None]\n",
    "    R3  = data[:,55:56].flatten()[:,None]\n",
    "    R4  = data[:,56:57].flatten()[:,None]\n",
    "    R5  = data[:,57:58].flatten()[:,None]\n",
    "    R6  = data[:,58:59].flatten()[:,None]\n",
    "    R7  = data[:,59:60].flatten()[:,None]\n",
    "    R8  = data[:,60:61].flatten()[:,None]\n",
    "    R9  = data[:,61:62].flatten()[:,None]\n",
    "    R10 = data[:,62:63].flatten()[:,None]\n",
    "    R11 = data[:,63:64].flatten()[:,None]\n",
    "    R12 = data[:,64:65].flatten()[:,None]\n",
    "    R13 = data[:,65:66].flatten()[:,None]\n",
    "    R14 = data[:,66:67].flatten()[:,None]\n",
    "    R15 = data[:,67:68].flatten()[:,None]\n",
    "    R16 = data[:,68:69].flatten()[:,None]\n",
    "    R17 = data[:,69:70].flatten()[:,None]\n",
    "    R18 = data[:,70:71].flatten()[:,None]\n",
    "    R19 = data[:,71:72].flatten()[:,None]\n",
    "    R20 = data[:,72:73].flatten()[:,None]\n",
    "    R21 = data[:,73:74].flatten()[:,None]\n",
    "    R22 = data[:,74:75].flatten()[:,None]\n",
    "    R23 = data[:,75:76].flatten()[:,None]\n",
    "    R24 = data[:,76:77].flatten()[:,None]\n",
    "    R25 = data[:,77:78].flatten()[:,None]\n",
    "    R26 = data[:,78:79].flatten()[:,None]\n",
    "    R27 = data[:,79:80].flatten()[:,None]\n",
    "    R28 = data[:,80:81].flatten()[:,None]\n",
    "    R29 = data[:,81:82].flatten()[:,None]\n",
    "    R30 = data[:,82:83].flatten()[:,None]\n",
    "    R31 = data[:,83:84].flatten()[:,None]\n",
    "    R32 = data[:,84:85].flatten()[:,None]\n",
    "    R33 = data[:,85:86].flatten()[:,None]\n",
    "    R34 = data[:,86:87].flatten()[:,None]\n",
    "    R35 = data[:,87:88].flatten()[:,None]\n",
    "    R36 = data[:,88:89].flatten()[:,None]\n",
    "    R37 = data[:,89:90].flatten()[:,None]\n",
    "    R38 = data[:,90:91].flatten()[:,None]\n",
    "    R39 = data[:,91:92].flatten()[:,None]\n",
    "    R40 = data[:,92:93].flatten()[:,None]\n",
    "    R41 = data[:,93:94].flatten()[:,None]\n",
    "    R42 = data[:,94:95].flatten()[:,None]\n",
    "    R43 = data[:,95:96].flatten()[:,None]\n",
    "    R44 = data[:,96:97].flatten()[:,None]\n",
    "    R45 = data[:,97:98].flatten()[:,None]\n",
    "    R46 = data[:,98:99].flatten()[:,None]\n",
    "    R47 = data[:,99:100].flatten()[:,None]\n",
    "    Rat = data[:,100:101].flatten()[:,None]\n",
    "\n",
    "    [x_train,   x_test,\n",
    "     n1_train,  n1_test,\n",
    "     n2_train,  n2_test,\n",
    "     n3_train,  n3_test,\n",
    "     n4_train,  n4_test,\n",
    "     n5_train,  n5_test,\n",
    "     n6_train,  n6_test,\n",
    "     n7_train,  n7_test,\n",
    "     n8_train,  n8_test,\n",
    "     n9_train,  n9_test,\n",
    "     n10_train, n10_test,\n",
    "     n11_train, n11_test,\n",
    "     n12_train, n12_test,\n",
    "     n13_train, n13_test,\n",
    "     n14_train, n14_test,\n",
    "     n15_train, n15_test,\n",
    "     n16_train, n16_test,\n",
    "     n17_train, n17_test,\n",
    "     n18_train, n18_test,\n",
    "     n19_train, n19_test,\n",
    "     n20_train, n20_test,\n",
    "     n21_train, n21_test,\n",
    "     n22_train, n22_test,\n",
    "     n23_train, n23_test,\n",
    "     n24_train, n24_test,\n",
    "     n25_train, n25_test,\n",
    "     n26_train, n26_test,\n",
    "     n27_train, n27_test,\n",
    "     n28_train, n28_test,\n",
    "     n29_train, n29_test,\n",
    "     n30_train, n30_test,\n",
    "     n31_train, n31_test,\n",
    "     n32_train, n32_test,\n",
    "     n33_train, n33_test,\n",
    "     n34_train, n34_test,\n",
    "     n35_train, n35_test,\n",
    "     n36_train, n36_test,\n",
    "     n37_train, n37_test,\n",
    "     n38_train, n38_test,\n",
    "     n39_train, n39_test,\n",
    "     n40_train, n40_test,\n",
    "     n41_train, n41_test,\n",
    "     n42_train, n42_test,\n",
    "     n43_train, n43_test,\n",
    "     n44_train, n44_test,\n",
    "     n45_train, n45_test,\n",
    "     n46_train, n46_test,\n",
    "     n47_train, n47_test,\n",
    "     nat_train, nat_test,\n",
    "     rho_train, rho_test,\n",
    "     u_train,   u_test,\n",
    "     p_train,   p_test,\n",
    "     E_train,   E_test,\n",
    "     R1_train,  R1_test,\n",
    "     R2_train,  R2_test,\n",
    "     R3_train,  R3_test,\n",
    "     R4_train,  R4_test,\n",
    "     R5_train,  R5_test,\n",
    "     R6_train,  R6_test,\n",
    "     R7_train,  R7_test,\n",
    "     R8_train,  R8_test,\n",
    "     R9_train,  R9_test,\n",
    "     R10_train, R10_test,\n",
    "     R11_train, R11_test,\n",
    "     R12_train, R12_test,\n",
    "     R13_train, R13_test,\n",
    "     R14_train, R14_test,\n",
    "     R15_train, R15_test,\n",
    "     R16_train, R16_test,\n",
    "     R17_train, R17_test,\n",
    "     R18_train, R18_test,\n",
    "     R19_train, R19_test,\n",
    "     R20_train, R20_test,\n",
    "     R21_train, R21_test,\n",
    "     R22_train, R22_test,\n",
    "     R23_train, R23_test,\n",
    "     R24_train, R24_test,\n",
    "     R25_train, R25_test,\n",
    "     R26_train, R26_test,\n",
    "     R27_train, R27_test,\n",
    "     R28_train, R28_test,\n",
    "     R29_train, R29_test,\n",
    "     R30_train, R30_test,\n",
    "     R31_train, R31_test,\n",
    "     R32_train, R32_test,\n",
    "     R33_train, R33_test,\n",
    "     R34_train, R34_test,\n",
    "     R35_train, R35_test,\n",
    "     R36_train, R36_test,\n",
    "     R37_train, R37_test,\n",
    "     R38_train, R38_test,\n",
    "     R39_train, R39_test,\n",
    "     R40_train, R40_test,\n",
    "     R41_train, R41_test,\n",
    "     R42_train, R42_test,\n",
    "     R43_train, R43_test,\n",
    "     R44_train, R44_test,\n",
    "     R45_train, R45_test,\n",
    "     R46_train, R46_test,\n",
    "     R47_train, R47_test,\n",
    "     Rat_train, Rat_test] = train_test_split(x, n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12, n13, n14, n15, n16, n17, n18,\n",
    "                                                n19, n20, n21, n22, n23, n24, n25, n26, n27, n28, n29, n30, n31, n32, n33, n34,\n",
    "                                                n35, n36, n37, n38, n39, n40, n41, n42, n43, n44, n45, n46, n47, nat,\n",
    "                                                rho, u, p, E,\n",
    "                                                R1, R2, R3, R4, R5, R6, R7, R8, R9, R10, R11, R12, R13, R14, R15, R16, R17, R18,\n",
    "                                                R19, R20, R21, R22, R23, R24, R25, R26, R27, R28, R29, R30, R31, R32, R33, R34,\n",
    "                                                R35, R36, R37, R38, R39, R40, R41, R42, R43, R44, R45, R46, R47,\n",
    "                                                Rat, test_size=0.20, random_state=0)\n",
    "\n",
    "    sc_x   = MinMaxScaler() #StandardScaler() RobustScaler() MaxAbsScaler()\n",
    "    sc_n1  = MinMaxScaler()\n",
    "    sc_n2  = MinMaxScaler()\n",
    "    sc_n3  = MinMaxScaler()\n",
    "    sc_n4  = MinMaxScaler()\n",
    "    sc_n5  = MinMaxScaler()\n",
    "    sc_n6  = MinMaxScaler()\n",
    "    sc_n7  = MinMaxScaler()\n",
    "    sc_n8  = MinMaxScaler()\n",
    "    sc_n9  = MinMaxScaler()\n",
    "    sc_n10 = MinMaxScaler()\n",
    "    sc_n11 = MinMaxScaler()\n",
    "    sc_n12 = MinMaxScaler()\n",
    "    sc_n12 = MinMaxScaler()\n",
    "    sc_n13 = MinMaxScaler()\n",
    "    sc_n14 = MinMaxScaler()\n",
    "    sc_n15 = MinMaxScaler()\n",
    "    sc_n16 = MinMaxScaler()\n",
    "    sc_n17 = MinMaxScaler()\n",
    "    sc_n18 = MinMaxScaler()\n",
    "    sc_n19 = MinMaxScaler()\n",
    "    sc_n20 = MinMaxScaler()\n",
    "    sc_n21 = MinMaxScaler()\n",
    "    sc_n22 = MinMaxScaler()\n",
    "    sc_n23 = MinMaxScaler()\n",
    "    sc_n24 = MinMaxScaler()\n",
    "    sc_n25 = MinMaxScaler()\n",
    "    sc_n26 = MinMaxScaler()\n",
    "    sc_n27 = MinMaxScaler()\n",
    "    sc_n28 = MinMaxScaler()\n",
    "    sc_n29 = MinMaxScaler()\n",
    "    sc_n30 = MinMaxScaler()\n",
    "    sc_n31 = MinMaxScaler()\n",
    "    sc_n32 = MinMaxScaler()\n",
    "    sc_n33 = MinMaxScaler()\n",
    "    sc_n34 = MinMaxScaler()\n",
    "    sc_n35 = MinMaxScaler()\n",
    "    sc_n36 = MinMaxScaler()\n",
    "    sc_n37 = MinMaxScaler()\n",
    "    sc_n38 = MinMaxScaler()\n",
    "    sc_n39 = MinMaxScaler()\n",
    "    sc_n40 = MinMaxScaler()\n",
    "    sc_n41 = MinMaxScaler()\n",
    "    sc_n42 = MinMaxScaler()\n",
    "    sc_n43 = MinMaxScaler()\n",
    "    sc_n44 = MinMaxScaler()\n",
    "    sc_n45 = MinMaxScaler()\n",
    "    sc_n46 = MinMaxScaler()\n",
    "    sc_n47 = MinMaxScaler()\n",
    "    sc_nat = MinMaxScaler()\n",
    "    sc_rho = MinMaxScaler()\n",
    "    sc_u   = MinMaxScaler()\n",
    "    sc_p   = MinMaxScaler()\n",
    "    sc_E   = MinMaxScaler()\n",
    "    sc_R1  = MinMaxScaler()\n",
    "    sc_R2  = MinMaxScaler()\n",
    "    sc_R3  = MinMaxScaler()\n",
    "    sc_R4  = MinMaxScaler()\n",
    "    sc_R5  = MinMaxScaler()\n",
    "    sc_R6  = MinMaxScaler()\n",
    "    sc_R7  = MinMaxScaler()\n",
    "    sc_R8  = MinMaxScaler()\n",
    "    sc_R9  = MinMaxScaler()\n",
    "    sc_R10 = MinMaxScaler()\n",
    "    sc_R11 = MinMaxScaler()\n",
    "    sc_R12 = MinMaxScaler()\n",
    "    sc_R13 = MinMaxScaler()\n",
    "    sc_R14 = MinMaxScaler()\n",
    "    sc_R15 = MinMaxScaler()\n",
    "    sc_R16 = MinMaxScaler()\n",
    "    sc_R17 = MinMaxScaler()\n",
    "    sc_R18 = MinMaxScaler()\n",
    "    sc_R19 = MinMaxScaler()\n",
    "    sc_R20 = MinMaxScaler()\n",
    "    sc_R21 = MinMaxScaler()\n",
    "    sc_R22 = MinMaxScaler()\n",
    "    sc_R23 = MinMaxScaler()\n",
    "    sc_R24 = MinMaxScaler()\n",
    "    sc_R25 = MinMaxScaler()\n",
    "    sc_R26 = MinMaxScaler()\n",
    "    sc_R27 = MinMaxScaler()\n",
    "    sc_R28 = MinMaxScaler()\n",
    "    sc_R29 = MinMaxScaler()\n",
    "    sc_R30 = MinMaxScaler()\n",
    "    sc_R31 = MinMaxScaler()\n",
    "    sc_R32 = MinMaxScaler()\n",
    "    sc_R33 = MinMaxScaler()\n",
    "    sc_R34 = MinMaxScaler()\n",
    "    sc_R35 = MinMaxScaler()\n",
    "    sc_R36 = MinMaxScaler()\n",
    "    sc_R37 = MinMaxScaler()\n",
    "    sc_R38 = MinMaxScaler()\n",
    "    sc_R39 = MinMaxScaler()\n",
    "    sc_R40 = MinMaxScaler()\n",
    "    sc_R41 = MinMaxScaler()\n",
    "    sc_R42 = MinMaxScaler()\n",
    "    sc_R43 = MinMaxScaler()\n",
    "    sc_R44 = MinMaxScaler()\n",
    "    sc_R45 = MinMaxScaler()\n",
    "    sc_R46 = MinMaxScaler()\n",
    "    sc_R47 = MinMaxScaler()\n",
    "    sc_Rat = MinMaxScaler()\n",
    "\n",
    "    # Training set\n",
    "    x_train   = sc_x.fit_transform(x_train)\n",
    "\n",
    "    n1_train  = sc_n1.fit_transform(n1_train)\n",
    "    n2_train  = sc_n2.fit_transform(n2_train)\n",
    "    n3_train  = sc_n3.fit_transform(n3_train)\n",
    "    n4_train  = sc_n4.fit_transform(n4_train)\n",
    "    n5_train  = sc_n5.fit_transform(n5_train)\n",
    "    n6_train  = sc_n6.fit_transform(n6_train)\n",
    "    n7_train  = sc_n7.fit_transform(n7_train)\n",
    "    n8_train  = sc_n8.fit_transform(n8_train)\n",
    "    n9_train  = sc_n9.fit_transform(n9_train)\n",
    "    n10_train = sc_n10.fit_transform(n10_train)\n",
    "    n11_train = sc_n11.fit_transform(n11_train)\n",
    "    n12_train = sc_n12.fit_transform(n12_train)\n",
    "    n13_train = sc_n13.fit_transform(n13_train)\n",
    "    n14_train = sc_n14.fit_transform(n14_train)\n",
    "    n15_train = sc_n15.fit_transform(n15_train)\n",
    "    n16_train = sc_n16.fit_transform(n16_train)\n",
    "    n17_train = sc_n17.fit_transform(n17_train)\n",
    "    n18_train = sc_n18.fit_transform(n18_train)\n",
    "    n19_train = sc_n19.fit_transform(n19_train)\n",
    "    n20_train = sc_n20.fit_transform(n20_train)\n",
    "    n21_train = sc_n21.fit_transform(n21_train)\n",
    "    n22_train = sc_n22.fit_transform(n22_train)\n",
    "    n23_train = sc_n23.fit_transform(n23_train)\n",
    "    n24_train = sc_n24.fit_transform(n24_train)\n",
    "    n25_train = sc_n25.fit_transform(n25_train)\n",
    "    n26_train = sc_n26.fit_transform(n26_train)\n",
    "    n27_train = sc_n27.fit_transform(n27_train)\n",
    "    n28_train = sc_n28.fit_transform(n28_train)\n",
    "    n29_train = sc_n29.fit_transform(n29_train)\n",
    "    n30_train = sc_n30.fit_transform(n30_train)\n",
    "    n31_train = sc_n31.fit_transform(n31_train)\n",
    "    n32_train = sc_n32.fit_transform(n32_train)\n",
    "    n33_train = sc_n33.fit_transform(n33_train)\n",
    "    n34_train = sc_n34.fit_transform(n34_train)\n",
    "    n35_train = sc_n35.fit_transform(n35_train)\n",
    "    n36_train = sc_n36.fit_transform(n36_train)\n",
    "    n37_train = sc_n37.fit_transform(n37_train)\n",
    "    n38_train = sc_n38.fit_transform(n38_train)\n",
    "    n39_train = sc_n39.fit_transform(n39_train)\n",
    "    n40_train = sc_n40.fit_transform(n40_train)\n",
    "    n41_train = sc_n41.fit_transform(n41_train)\n",
    "    n42_train = sc_n42.fit_transform(n42_train)\n",
    "    n43_train = sc_n43.fit_transform(n43_train)\n",
    "    n44_train = sc_n44.fit_transform(n44_train)\n",
    "    n45_train = sc_n45.fit_transform(n45_train)\n",
    "    n46_train = sc_n46.fit_transform(n46_train)\n",
    "    n47_train = sc_n47.fit_transform(n47_train)\n",
    "\n",
    "    nat_train = sc_nat.fit_transform(nat_train)\n",
    "    rho_train = sc_rho.fit_transform(rho_train)\n",
    "    u_train   = sc_u.fit_transform(u_train)\n",
    "    p_train   = sc_p.fit_transform(p_train)\n",
    "    E_train   = sc_E.fit_transform(E_train)\n",
    "\n",
    "    R1_train  = sc_R1.fit_transform(R1_train)\n",
    "    R2_train  = sc_R2.fit_transform(R2_train)\n",
    "    R3_train  = sc_R3.fit_transform(R3_train)\n",
    "    R4_train  = sc_R4.fit_transform(R4_train)\n",
    "    R5_train  = sc_R5.fit_transform(R5_train)\n",
    "    R6_train  = sc_R6.fit_transform(R6_train)\n",
    "    R7_train  = sc_R7.fit_transform(R7_train)\n",
    "    R8_train  = sc_R8.fit_transform(R8_train)\n",
    "    R9_train  = sc_R9.fit_transform(R9_train)\n",
    "    R10_train = sc_R10.fit_transform(R10_train)\n",
    "    R11_train = sc_R11.fit_transform(R11_train)\n",
    "    R12_train = sc_R12.fit_transform(R12_train)\n",
    "    R13_train = sc_R13.fit_transform(R13_train)\n",
    "    R14_train = sc_R14.fit_transform(R14_train)\n",
    "    R15_train = sc_R15.fit_transform(R15_train)\n",
    "    R16_train = sc_R16.fit_transform(R16_train)\n",
    "    R17_train = sc_R17.fit_transform(R17_train)\n",
    "    R18_train = sc_R18.fit_transform(R18_train)\n",
    "    R19_train = sc_R19.fit_transform(R19_train)\n",
    "    R20_train = sc_R20.fit_transform(R20_train)\n",
    "    R21_train = sc_R21.fit_transform(R21_train)\n",
    "    R22_train = sc_R22.fit_transform(R22_train)\n",
    "    R23_train = sc_R23.fit_transform(R23_train)\n",
    "    R24_train = sc_R24.fit_transform(R24_train)\n",
    "    R25_train = sc_R25.fit_transform(R25_train)\n",
    "    R26_train = sc_R26.fit_transform(R26_train)\n",
    "    R27_train = sc_R27.fit_transform(R27_train)\n",
    "    R28_train = sc_R28.fit_transform(R28_train)\n",
    "    R29_train = sc_R29.fit_transform(R29_train)\n",
    "    R30_train = sc_R30.fit_transform(R30_train)\n",
    "    R31_train = sc_R31.fit_transform(R31_train)\n",
    "    R32_train = sc_R32.fit_transform(R32_train)\n",
    "    R33_train = sc_R33.fit_transform(R33_train)\n",
    "    R34_train = sc_R34.fit_transform(R34_train)\n",
    "    R35_train = sc_R35.fit_transform(R35_train)\n",
    "    R36_train = sc_R36.fit_transform(R36_train)\n",
    "    R37_train = sc_R37.fit_transform(R37_train)\n",
    "    R38_train = sc_R38.fit_transform(R38_train)\n",
    "    R39_train = sc_R39.fit_transform(R39_train)\n",
    "    R40_train = sc_R40.fit_transform(R40_train)\n",
    "    R41_train = sc_R41.fit_transform(R41_train)\n",
    "    R42_train = sc_R42.fit_transform(R42_train)\n",
    "    R43_train = sc_R43.fit_transform(R43_train)\n",
    "    R44_train = sc_R44.fit_transform(R44_train)\n",
    "    R45_train = sc_R45.fit_transform(R45_train)\n",
    "    R46_train = sc_R46.fit_transform(R46_train)\n",
    "    R47_train = sc_R47.fit_transform(R47_train)\n",
    "    Rat_train = sc_Rat.fit_transform(Rat_train)\n",
    "\n",
    "    # Testing set\n",
    "    x_test   = sc_x.fit_transform(x_test)\n",
    "\n",
    "    n1_test  = sc_n1.fit_transform(n1_test)\n",
    "    n2_test  = sc_n2.fit_transform(n2_test)\n",
    "    n3_test  = sc_n3.fit_transform(n3_test)\n",
    "    n4_test  = sc_n4.fit_transform(n4_test)\n",
    "    n5_test  = sc_n5.fit_transform(n5_test)\n",
    "    n6_test  = sc_n6.fit_transform(n6_test)\n",
    "    n7_test  = sc_n7.fit_transform(n7_test)\n",
    "    n8_test  = sc_n8.fit_transform(n8_test)\n",
    "    n9_test  = sc_n9.fit_transform(n9_test)\n",
    "    n10_test = sc_n10.fit_transform(n10_test)\n",
    "    n11_test = sc_n11.fit_transform(n11_test)\n",
    "    n12_test = sc_n12.fit_transform(n12_test)\n",
    "    n13_test = sc_n13.fit_transform(n13_test)\n",
    "    n14_test = sc_n14.fit_transform(n14_test)\n",
    "    n15_test = sc_n15.fit_transform(n15_test)\n",
    "    n16_test = sc_n16.fit_transform(n16_test)\n",
    "    n17_test = sc_n17.fit_transform(n17_test)\n",
    "    n18_test = sc_n18.fit_transform(n18_test)\n",
    "    n19_test = sc_n19.fit_transform(n19_test)\n",
    "    n20_test = sc_n20.fit_transform(n20_test)\n",
    "    n21_test = sc_n21.fit_transform(n21_test)\n",
    "    n22_test = sc_n22.fit_transform(n22_test)\n",
    "    n23_test = sc_n23.fit_transform(n23_test)\n",
    "    n24_test = sc_n24.fit_transform(n24_test)\n",
    "    n25_test = sc_n25.fit_transform(n25_test)\n",
    "    n26_test = sc_n26.fit_transform(n26_test)\n",
    "    n27_test = sc_n27.fit_transform(n27_test)\n",
    "    n28_test = sc_n28.fit_transform(n28_test)\n",
    "    n29_test = sc_n29.fit_transform(n29_test)\n",
    "    n30_test = sc_n30.fit_transform(n30_test)\n",
    "    n31_test = sc_n31.fit_transform(n31_test)\n",
    "    n32_test = sc_n32.fit_transform(n32_test)\n",
    "    n33_test = sc_n33.fit_transform(n33_test)\n",
    "    n34_test = sc_n34.fit_transform(n34_test)\n",
    "    n35_test = sc_n35.fit_transform(n35_test)\n",
    "    n36_test = sc_n36.fit_transform(n36_test)\n",
    "    n37_test = sc_n37.fit_transform(n37_test)\n",
    "    n38_test = sc_n38.fit_transform(n38_test)\n",
    "    n39_test = sc_n39.fit_transform(n39_test)\n",
    "    n40_test = sc_n40.fit_transform(n40_test)\n",
    "    n41_test = sc_n41.fit_transform(n41_test)\n",
    "    n42_test = sc_n42.fit_transform(n42_test)\n",
    "    n43_test = sc_n43.fit_transform(n43_test)\n",
    "    n44_test = sc_n44.fit_transform(n44_test)\n",
    "    n45_test = sc_n45.fit_transform(n45_test)\n",
    "    n46_test = sc_n46.fit_transform(n46_test)\n",
    "    n47_test = sc_n47.fit_transform(n47_test)\n",
    "\n",
    "    nat_test = sc_nat.fit_transform(nat_test)\n",
    "    rho_test = sc_rho.fit_transform(rho_test)\n",
    "    u_test   = sc_u.fit_transform(u_test)\n",
    "    p_test   = sc_p.fit_transform(p_test)\n",
    "    E_test   = sc_E.fit_transform(E_test)\n",
    "\n",
    "    R1_test  = sc_R1.fit_transform(R1_test)\n",
    "    R2_test  = sc_R2.fit_transform(R2_test)\n",
    "    R3_test  = sc_R3.fit_transform(R3_test)\n",
    "    R4_test  = sc_R4.fit_transform(R4_test)\n",
    "    R5_test  = sc_R5.fit_transform(R5_test)\n",
    "    R6_test  = sc_R6.fit_transform(R6_test)\n",
    "    R7_test  = sc_R7.fit_transform(R7_test)\n",
    "    R8_test  = sc_R8.fit_transform(R8_test)\n",
    "    R9_test  = sc_R9.fit_transform(R9_test)\n",
    "    R10_test = sc_R10.fit_transform(R10_test)\n",
    "    R11_test = sc_R11.fit_transform(R11_test)\n",
    "    R12_test = sc_R12.fit_transform(R12_test)\n",
    "    R13_test = sc_R13.fit_transform(R13_test)\n",
    "    R14_test = sc_R14.fit_transform(R14_test)\n",
    "    R15_test = sc_R15.fit_transform(R15_test)\n",
    "    R16_test = sc_R16.fit_transform(R16_test)\n",
    "    R17_test = sc_R17.fit_transform(R17_test)\n",
    "    R18_test = sc_R18.fit_transform(R18_test)\n",
    "    R19_test = sc_R19.fit_transform(R19_test)\n",
    "    R20_test = sc_R20.fit_transform(R20_test)\n",
    "    R21_test = sc_R21.fit_transform(R21_test)\n",
    "    R22_test = sc_R22.fit_transform(R22_test)\n",
    "    R23_test = sc_R23.fit_transform(R23_test)\n",
    "    R24_test = sc_R24.fit_transform(R24_test)\n",
    "    R25_test = sc_R25.fit_transform(R25_test)\n",
    "    R26_test = sc_R26.fit_transform(R26_test)\n",
    "    R27_test = sc_R27.fit_transform(R27_test)\n",
    "    R28_test = sc_R28.fit_transform(R28_test)\n",
    "    R29_test = sc_R29.fit_transform(R29_test)\n",
    "    R30_test = sc_R30.fit_transform(R30_test)\n",
    "    R31_test = sc_R31.fit_transform(R31_test)\n",
    "    R32_test = sc_R32.fit_transform(R32_test)\n",
    "    R33_test = sc_R33.fit_transform(R33_test)\n",
    "    R34_test = sc_R34.fit_transform(R34_test)\n",
    "    R35_test = sc_R35.fit_transform(R35_test)\n",
    "    R36_test = sc_R36.fit_transform(R36_test)\n",
    "    R37_test = sc_R37.fit_transform(R37_test)\n",
    "    R38_test = sc_R38.fit_transform(R38_test)\n",
    "    R39_test = sc_R39.fit_transform(R39_test)\n",
    "    R40_test = sc_R40.fit_transform(R40_test)\n",
    "    R41_test = sc_R41.fit_transform(R41_test)\n",
    "    R42_test = sc_R42.fit_transform(R42_test)\n",
    "    R43_test = sc_R43.fit_transform(R43_test)\n",
    "    R44_test = sc_R44.fit_transform(R44_test)\n",
    "    R45_test = sc_R45.fit_transform(R45_test)\n",
    "    R46_test = sc_R46.fit_transform(R46_test)\n",
    "    R47_test = sc_R47.fit_transform(R47_test)\n",
    "    Rat_test = sc_Rat.fit_transform(Rat_test)\n",
    "\n",
    "    # Training the NN based on the training set, randomly chosen above model\n",
    "    # = PINN(..) passes the necessary training data to the 'NN' class (model\n",
    "    # here being an instance of the NN class) in order to initialize all the\n",
    "    # parameters as well as the NN architecture including random initialization\n",
    "    # of weights and biases.\n",
    "    model = PINN(x_train,\n",
    "                 n1_train,  n2_train,  n3_train,  n4_train,  n5_train,  n6_train,  n7_train,  n8_train,  n9_train,  n10_train,\n",
    "                 n11_train, n12_train, n13_train, n14_train, n15_train, n16_train, n17_train, n18_train, n19_train, n20_train,\n",
    "                 n21_train, n22_train, n23_train, n24_train, n25_train, n26_train, n27_train, n28_train, n29_train, n30_train,\n",
    "                 n31_train, n32_train, n33_train, n34_train, n35_train, n36_train, n37_train, n38_train, n39_train, n40_train,\n",
    "                 n41_train, n42_train, n43_train, n44_train, n45_train, n46_train, n47_train, nat_train,\n",
    "                 rho_train, u_train, p_train, E_train,\n",
    "                 R1_train,  R2_train,  R3_train,  R4_train,  R5_train,  R6_train,  R7_train,  R8_train,  R9_train,  R10_train,\n",
    "                 R11_train, R12_train, R13_train, R14_train, R15_train, R16_train, R17_train, R18_train, R19_train, R20_train,\n",
    "                 R21_train, R22_train, R23_train, R24_train, R25_train, R26_train, R27_train, R28_train, R29_train, R30_train,\n",
    "                 R31_train, R32_train, R33_train, R34_train, R35_train, R36_train, R37_train, R38_train, R39_train, R40_train,\n",
    "                 R41_train, R42_train, R43_train, R44_train, R45_train, R46_train, R47_train, Rat_train, layers)\n",
    "\n",
    "    model.train(10000)\n",
    "\n",
    "    # Plotting Loss\n",
    "    plt.plot(loss_vector, label='Loss value')\n",
    "    plt.legend()\n",
    "    plt.title('Loss value over iterations')\n",
    "    plt.xlabel('Iterations')\n",
    "    plt.ylabel('Loss')\n",
    "    plt.show()\n",
    "    plt.savefig('./figures/Loss', crop = False)\n",
    "\n",
    "    # Prediction\n",
    "    # The input parameters of the test set are used to predict the pressure, density, speed and specific energy for the\n",
    "    # given x and t by using the .predict method.\n",
    "    [n1_pred, n2_pred,  n3_pred,  n4_pred,  n5_pred,  n6_pred,  n7_pred,  n8_pred,  n9_pred,  n10_pred, n11_pred, n12_pred,\n",
    "    n13_pred, n14_pred, n15_pred, n16_pred, n17_pred, n18_pred, n19_pred, n20_pred, n21_pred, n22_pred, n23_pred, n24_pred,\n",
    "    n25_pred, n26_pred, n27_pred, n28_pred, n29_pred, n30_pred, n31_pred, n32_pred, n33_pred, n34_pred, n35_pred, n36_pred,\n",
    "    n37_pred, n38_pred, n39_pred, n40_pred, n41_pred, n42_pred, n43_pred, n44_pred, n45_pred, n46_pred, n47_pred, nat_pred,\n",
    "    rho_pred, u_pred, p_pred, E_pred,\n",
    "    R1_pred,  R2_pred,  R3_pred,  R4_pred,  R5_pred,  R6_pred,  R7_pred,  R8_pred,  R9_pred,  R10_pred, R11_pred, R12_pred,\n",
    "    R13_pred, R14_pred, R15_pred, R16_pred, R17_pred, R18_pred, R19_pred, R20_pred, R21_pred, R22_pred, R23_pred, R24_pred,\n",
    "    R25_pred, R26_pred, R27_pred, R28_pred, R29_pred, R30_pred, R31_pred, R32_pred, R33_pred, R34_pred, R35_pred, R36_pred,\n",
    "    R37_pred, R38_pred, R39_pred, R40_pred, R41_pred, R42_pred, R43_pred, R44_pred, R45_pred, R46_pred, R47_pred,\n",
    "    Rat_pred] = model.predict(x_test)\n",
    "\n",
    "# Error\n",
    "# Normal relative error is printed for each variable\n",
    "error_n1  = np.linalg.norm(n1_test -n1_pred ,2)/np.linalg.norm(n1_test ,2)\n",
    "error_n2  = np.linalg.norm(n2_test -n2_pred ,2)/np.linalg.norm(n2_test ,2)\n",
    "error_n3  = np.linalg.norm(n3_test -n3_pred ,2)/np.linalg.norm(n3_test ,2)\n",
    "error_n4  = np.linalg.norm(n4_test -n4_pred ,2)/np.linalg.norm(n4_test ,2)\n",
    "error_n5  = np.linalg.norm(n5_test -n5_pred ,2)/np.linalg.norm(n5_test ,2)\n",
    "error_n6  = np.linalg.norm(n6_test -n6_pred ,2)/np.linalg.norm(n6_test ,2)\n",
    "error_n7  = np.linalg.norm(n7_test -n7_pred ,2)/np.linalg.norm(n7_test ,2)\n",
    "error_n8  = np.linalg.norm(n8_test -n8_pred ,2)/np.linalg.norm(n8_test ,2)\n",
    "error_n9  = np.linalg.norm(n9_test -n9_pred ,2)/np.linalg.norm(n9_test ,2)\n",
    "error_n10 = np.linalg.norm(n10_test-n10_pred,2)/np.linalg.norm(n10_test,2)\n",
    "error_n11 = np.linalg.norm(n11_test-n11_pred,2)/np.linalg.norm(n11_test,2)\n",
    "error_n12 = np.linalg.norm(n12_test-n12_pred,2)/np.linalg.norm(n12_test,2)\n",
    "error_n13 = np.linalg.norm(n13_test-n13_pred,2)/np.linalg.norm(n13_test,2)\n",
    "error_n14 = np.linalg.norm(n14_test-n14_pred,2)/np.linalg.norm(n14_test,2)\n",
    "error_n15 = np.linalg.norm(n15_test-n15_pred,2)/np.linalg.norm(n15_test,2)\n",
    "error_n16 = np.linalg.norm(n16_test-n16_pred,2)/np.linalg.norm(n16_test,2)\n",
    "error_n17 = np.linalg.norm(n17_test-n17_pred,2)/np.linalg.norm(n17_test,2)\n",
    "error_n18 = np.linalg.norm(n18_test-n18_pred,2)/np.linalg.norm(n18_test,2)\n",
    "error_n19 = np.linalg.norm(n19_test-n19_pred,2)/np.linalg.norm(n19_test,2)\n",
    "error_n20 = np.linalg.norm(n20_test-n20_pred,2)/np.linalg.norm(n20_test,2)\n",
    "error_n21 = np.linalg.norm(n21_test-n21_pred,2)/np.linalg.norm(n21_test,2)\n",
    "error_n22 = np.linalg.norm(n22_test-n22_pred,2)/np.linalg.norm(n22_test,2)\n",
    "error_n23 = np.linalg.norm(n23_test-n23_pred,2)/np.linalg.norm(n23_test,2)\n",
    "error_n24 = np.linalg.norm(n24_test-n24_pred,2)/np.linalg.norm(n24_test,2)\n",
    "error_n25 = np.linalg.norm(n25_test-n25_pred,2)/np.linalg.norm(n25_test,2)\n",
    "error_n26 = np.linalg.norm(n26_test-n26_pred,2)/np.linalg.norm(n26_test,2)\n",
    "error_n27 = np.linalg.norm(n27_test-n27_pred,2)/np.linalg.norm(n27_test,2)\n",
    "error_n28 = np.linalg.norm(n28_test-n28_pred,2)/np.linalg.norm(n28_test,2)\n",
    "error_n29 = np.linalg.norm(n29_test-n29_pred,2)/np.linalg.norm(n29_test,2)\n",
    "error_n30 = np.linalg.norm(n30_test-n30_pred,2)/np.linalg.norm(n30_test,2)\n",
    "error_n31 = np.linalg.norm(n31_test-n31_pred,2)/np.linalg.norm(n31_test,2)\n",
    "error_n32 = np.linalg.norm(n32_test-n32_pred,2)/np.linalg.norm(n32_test,2)\n",
    "error_n33 = np.linalg.norm(n33_test-n33_pred,2)/np.linalg.norm(n33_test,2)\n",
    "error_n34 = np.linalg.norm(n34_test-n34_pred,2)/np.linalg.norm(n34_test,2)\n",
    "error_n35 = np.linalg.norm(n35_test-n35_pred,2)/np.linalg.norm(n35_test,2)\n",
    "error_n36 = np.linalg.norm(n36_test-n36_pred,2)/np.linalg.norm(n36_test,2)\n",
    "error_n37 = np.linalg.norm(n37_test-n37_pred,2)/np.linalg.norm(n37_test,2)\n",
    "error_n38 = np.linalg.norm(n38_test-n38_pred,2)/np.linalg.norm(n38_test,2)\n",
    "error_n39 = np.linalg.norm(n39_test-n39_pred,2)/np.linalg.norm(n39_test,2)\n",
    "error_n40 = np.linalg.norm(n40_test-n40_pred,2)/np.linalg.norm(n40_test,2)\n",
    "error_n41 = np.linalg.norm(n41_test-n41_pred,2)/np.linalg.norm(n41_test,2)\n",
    "error_n42 = np.linalg.norm(n42_test-n42_pred,2)/np.linalg.norm(n42_test,2)\n",
    "error_n43 = np.linalg.norm(n43_test-n43_pred,2)/np.linalg.norm(n43_test,2)\n",
    "error_n44 = np.linalg.norm(n44_test-n44_pred,2)/np.linalg.norm(n44_test,2)\n",
    "error_n45 = np.linalg.norm(n45_test-n45_pred,2)/np.linalg.norm(n45_test,2)\n",
    "error_n46 = np.linalg.norm(n46_test-n46_pred,2)/np.linalg.norm(n46_test,2)\n",
    "error_n47 = np.linalg.norm(n47_test-n47_pred,2)/np.linalg.norm(n47_test,2)\n",
    "error_nat = np.linalg.norm(nat_test-nat_pred,2)/np.linalg.norm(nat_test,2)\n",
    "error_rho = np.linalg.norm(rho_test-rho_pred,2)/np.linalg.norm(rho_test,2)\n",
    "error_u   = np.linalg.norm(u_test-u_pred,2)/np.linalg.norm(u_test,2)\n",
    "error_p   = np.linalg.norm(p_test-p_pred,2)/np.linalg.norm(p_test,2)\n",
    "error_E   = np.linalg.norm(E_test-E_pred,2)/np.linalg.norm(E_test,2)\n",
    "error_R1  = np.linalg.norm(R1_test -R1_pred ,2)/np.linalg.norm(R1_test ,2)\n",
    "error_R2  = np.linalg.norm(R2_test -R2_pred ,2)/np.linalg.norm(R2_test ,2)\n",
    "error_R3  = np.linalg.norm(R3_test -R3_pred ,2)/np.linalg.norm(R3_test ,2)\n",
    "error_R4  = np.linalg.norm(R4_test -R4_pred ,2)/np.linalg.norm(R4_test ,2)\n",
    "error_R5  = np.linalg.norm(R5_test -R5_pred ,2)/np.linalg.norm(R5_test ,2)\n",
    "error_R6  = np.linalg.norm(R6_test -R6_pred ,2)/np.linalg.norm(R6_test ,2)\n",
    "error_R7  = np.linalg.norm(R7_test -R7_pred ,2)/np.linalg.norm(R7_test ,2)\n",
    "error_R8  = np.linalg.norm(R8_test -R8_pred ,2)/np.linalg.norm(R8_test ,2)\n",
    "error_R9  = np.linalg.norm(R9_test -R9_pred ,2)/np.linalg.norm(R9_test ,2)\n",
    "error_R10 = np.linalg.norm(R10_test-R10_pred,2)/np.linalg.norm(R10_test,2)\n",
    "error_R11 = np.linalg.norm(R11_test-R11_pred,2)/np.linalg.norm(R11_test,2)\n",
    "error_R12 = np.linalg.norm(R12_test-R12_pred,2)/np.linalg.norm(R12_test,2)\n",
    "error_R13 = np.linalg.norm(R13_test-R13_pred,2)/np.linalg.norm(R13_test,2)\n",
    "error_R14 = np.linalg.norm(R14_test-R14_pred,2)/np.linalg.norm(R14_test,2)\n",
    "error_R15 = np.linalg.norm(R15_test-R15_pred,2)/np.linalg.norm(R15_test,2)\n",
    "error_R16 = np.linalg.norm(R16_test-R16_pred,2)/np.linalg.norm(R16_test,2)\n",
    "error_R17 = np.linalg.norm(R17_test-R17_pred,2)/np.linalg.norm(R17_test,2)\n",
    "error_R18 = np.linalg.norm(R18_test-R18_pred,2)/np.linalg.norm(R18_test,2)\n",
    "error_R19 = np.linalg.norm(R19_test-R19_pred,2)/np.linalg.norm(R19_test,2)\n",
    "error_R20 = np.linalg.norm(R20_test-R20_pred,2)/np.linalg.norm(R20_test,2)\n",
    "error_R21 = np.linalg.norm(R21_test-R21_pred,2)/np.linalg.norm(R21_test,2)\n",
    "error_R22 = np.linalg.norm(R22_test-R22_pred,2)/np.linalg.norm(R22_test,2)\n",
    "error_R23 = np.linalg.norm(R23_test-R23_pred,2)/np.linalg.norm(R23_test,2)\n",
    "error_R24 = np.linalg.norm(R24_test-R24_pred,2)/np.linalg.norm(R24_test,2)\n",
    "error_R25 = np.linalg.norm(R25_test-R25_pred,2)/np.linalg.norm(R25_test,2)\n",
    "error_R26 = np.linalg.norm(R26_test-R26_pred,2)/np.linalg.norm(R26_test,2)\n",
    "error_R27 = np.linalg.norm(R27_test-R27_pred,2)/np.linalg.norm(R27_test,2)\n",
    "error_R28 = np.linalg.norm(R28_test-R28_pred,2)/np.linalg.norm(R28_test,2)\n",
    "error_R29 = np.linalg.norm(R29_test-R29_pred,2)/np.linalg.norm(R29_test,2)\n",
    "error_R30 = np.linalg.norm(R30_test-R30_pred,2)/np.linalg.norm(R30_test,2)\n",
    "error_R31 = np.linalg.norm(R31_test-R31_pred,2)/np.linalg.norm(R31_test,2)\n",
    "error_R32 = np.linalg.norm(R32_test-R32_pred,2)/np.linalg.norm(R32_test,2)\n",
    "error_R33 = np.linalg.norm(R33_test-R33_pred,2)/np.linalg.norm(R33_test,2)\n",
    "error_R34 = np.linalg.norm(R34_test-R34_pred,2)/np.linalg.norm(R34_test,2)\n",
    "error_R35 = np.linalg.norm(R35_test-R35_pred,2)/np.linalg.norm(R35_test,2)\n",
    "error_R36 = np.linalg.norm(R36_test-R36_pred,2)/np.linalg.norm(R36_test,2)\n",
    "error_R37 = np.linalg.norm(R37_test-R37_pred,2)/np.linalg.norm(R37_test,2)\n",
    "error_R38 = np.linalg.norm(R38_test-R38_pred,2)/np.linalg.norm(R38_test,2)\n",
    "error_R39 = np.linalg.norm(R39_test-R39_pred,2)/np.linalg.norm(R39_test,2)\n",
    "error_R40 = np.linalg.norm(R40_test-R40_pred,2)/np.linalg.norm(R40_test,2)\n",
    "error_R41 = np.linalg.norm(R41_test-R41_pred,2)/np.linalg.norm(R41_test,2)\n",
    "error_R42 = np.linalg.norm(R42_test-R42_pred,2)/np.linalg.norm(R42_test,2)\n",
    "error_R43 = np.linalg.norm(R43_test-R43_pred,2)/np.linalg.norm(R43_test,2)\n",
    "error_R44 = np.linalg.norm(R44_test-R44_pred,2)/np.linalg.norm(R44_test,2)\n",
    "error_R45 = np.linalg.norm(R45_test-R45_pred,2)/np.linalg.norm(R45_test,2)\n",
    "error_R46 = np.linalg.norm(R46_test-R46_pred,2)/np.linalg.norm(R46_test,2)\n",
    "error_R47 = np.linalg.norm(R47_test-R47_pred,2)/np.linalg.norm(R47_test,2)\n",
    "error_Rat = np.linalg.norm(Rat_test-Rat_pred,2)/np.linalg.norm(Rat_test,2)\n",
    "\n",
    "print(\"Test Error in n1: \"+str(error_n1))\n",
    "print(\"Test Error in n2: \"+str(error_n2))\n",
    "# ...\n",
    "print(\"Test Error in rho: \"+str(error_rho))\n",
    "print(\"Test Error in u: \"+str(error_u))\n",
    "print(\"Test Error in p: \"+str(error_p))\n",
    "print(\"Test Error in E: \"+str(error_E))\n",
    "# ...\n",
    "print(\"Test Error in R1: \"+str(error_R1))\n",
    "print(\"Test Error in R2: \"+str(error_R2))\n",
    "\n",
    "x_train_sb   = sc_x.inverse_transform(x_train)\n",
    "n1_train_sb  = sc_n1.inverse_transform(n1_train)\n",
    "n2_train_sb  = sc_n2.inverse_transform(n2_train)\n",
    "n3_train_sb  = sc_n3.inverse_transform(n3_train)\n",
    "n4_train_sb  = sc_n4.inverse_transform(n4_train)\n",
    "n5_train_sb  = sc_n5.inverse_transform(n5_train)\n",
    "n6_train_sb  = sc_n6.inverse_transform(n6_train)\n",
    "n7_train_sb  = sc_n7.inverse_transform(n7_train)\n",
    "n8_train_sb  = sc_n8.inverse_transform(n8_train)\n",
    "n9_train_sb  = sc_n9.inverse_transform(n9_train)\n",
    "n10_train_sb = sc_n10.inverse_transform(n10_train)\n",
    "n11_train_sb = sc_n11.inverse_transform(n11_train)\n",
    "n12_train_sb = sc_n12.inverse_transform(n12_train)\n",
    "n13_train_sb = sc_n13.inverse_transform(n13_train)\n",
    "n14_train_sb = sc_n14.inverse_transform(n14_train)\n",
    "n15_train_sb = sc_n15.inverse_transform(n15_train)\n",
    "n16_train_sb = sc_n16.inverse_transform(n16_train)\n",
    "n17_train_sb = sc_n17.inverse_transform(n17_train)\n",
    "n18_train_sb = sc_n18.inverse_transform(n18_train)\n",
    "n19_train_sb = sc_n19.inverse_transform(n19_train)\n",
    "n20_train_sb = sc_n20.inverse_transform(n20_train)\n",
    "n21_train_sb = sc_n21.inverse_transform(n21_train)\n",
    "n22_train_sb = sc_n22.inverse_transform(n22_train)\n",
    "n23_train_sb = sc_n23.inverse_transform(n23_train)\n",
    "n24_train_sb = sc_n24.inverse_transform(n24_train)\n",
    "n25_train_sb = sc_n25.inverse_transform(n25_train)\n",
    "n26_train_sb = sc_n26.inverse_transform(n26_train)\n",
    "n27_train_sb = sc_n27.inverse_transform(n27_train)\n",
    "n28_train_sb = sc_n28.inverse_transform(n28_train)\n",
    "n29_train_sb = sc_n29.inverse_transform(n29_train)\n",
    "n30_train_sb = sc_n30.inverse_transform(n30_train)\n",
    "n31_train_sb = sc_n31.inverse_transform(n31_train)\n",
    "n32_train_sb = sc_n32.inverse_transform(n32_train)\n",
    "n33_train_sb = sc_n33.inverse_transform(n33_train)\n",
    "n34_train_sb = sc_n34.inverse_transform(n34_train)\n",
    "n35_train_sb = sc_n35.inverse_transform(n35_train)\n",
    "n36_train_sb = sc_n36.inverse_transform(n36_train)\n",
    "n37_train_sb = sc_n37.inverse_transform(n37_train)\n",
    "n38_train_sb = sc_n38.inverse_transform(n38_train)\n",
    "n39_train_sb = sc_n39.inverse_transform(n39_train)\n",
    "n40_train_sb = sc_n40.inverse_transform(n40_train)\n",
    "n41_train_sb = sc_n41.inverse_transform(n41_train)\n",
    "n42_train_sb = sc_n42.inverse_transform(n42_train)\n",
    "n43_train_sb = sc_n43.inverse_transform(n43_train)\n",
    "n44_train_sb = sc_n44.inverse_transform(n44_train)\n",
    "n45_train_sb = sc_n45.inverse_transform(n45_train)\n",
    "n46_train_sb = sc_n46.inverse_transform(n46_train)\n",
    "n47_train_sb = sc_n47.inverse_transform(n47_train)\n",
    "nat_train_sb = sc_nat.inverse_transform(nat_train)\n",
    "\n",
    "rho_train_sb = sc_rho.inverse_transform(rho_train)\n",
    "u_train_sb   = sc_u.inverse_transform(u_train)\n",
    "p_train_sb   = sc_p.inverse_transform(p_train)\n",
    "E_train_sb   = sc_E.inverse_transform(E_train)\n",
    "\n",
    "R1_train_sb  = sc_R1.inverse_transform(R1_train)\n",
    "R2_train_sb  = sc_R2.inverse_transform(R2_train)\n",
    "R3_train_sb  = sc_R3.inverse_transform(R3_train)\n",
    "R4_train_sb  = sc_R4.inverse_transform(R4_train)\n",
    "R5_train_sb  = sc_R5.inverse_transform(R5_train)\n",
    "R6_train_sb  = sc_R6.inverse_transform(R6_train)\n",
    "R7_train_sb  = sc_R7.inverse_transform(R7_train)\n",
    "R8_train_sb  = sc_R8.inverse_transform(R8_train)\n",
    "R9_train_sb  = sc_R9.inverse_transform(R9_train)\n",
    "R10_train_sb = sc_R10.inverse_transform(R10_train)\n",
    "R11_train_sb = sc_R11.inverse_transform(R11_train)\n",
    "R12_train_sb = sc_R12.inverse_transform(R12_train)\n",
    "R13_train_sb = sc_R13.inverse_transform(R13_train)\n",
    "R14_train_sb = sc_R14.inverse_transform(R14_train)\n",
    "R15_train_sb = sc_R15.inverse_transform(R15_train)\n",
    "R16_train_sb = sc_R16.inverse_transform(R16_train)\n",
    "R17_train_sb = sc_R17.inverse_transform(R17_train)\n",
    "R18_train_sb = sc_R18.inverse_transform(R18_train)\n",
    "R19_train_sb = sc_R19.inverse_transform(R19_train)\n",
    "R20_train_sb = sc_R20.inverse_transform(R20_train)\n",
    "R21_train_sb = sc_R21.inverse_transform(R21_train)\n",
    "R22_train_sb = sc_R22.inverse_transform(R22_train)\n",
    "R23_train_sb = sc_R23.inverse_transform(R23_train)\n",
    "R24_train_sb = sc_R24.inverse_transform(R24_train)\n",
    "R25_train_sb = sc_R25.inverse_transform(R25_train)\n",
    "R26_train_sb = sc_R26.inverse_transform(R26_train)\n",
    "R27_train_sb = sc_R27.inverse_transform(R27_train)\n",
    "R28_train_sb = sc_R28.inverse_transform(R28_train)\n",
    "R29_train_sb = sc_R29.inverse_transform(R29_train)\n",
    "R30_train_sb = sc_R30.inverse_transform(R30_train)\n",
    "R31_train_sb = sc_R31.inverse_transform(R31_train)\n",
    "R32_train_sb = sc_R32.inverse_transform(R32_train)\n",
    "R33_train_sb = sc_R33.inverse_transform(R33_train)\n",
    "R34_train_sb = sc_R34.inverse_transform(R34_train)\n",
    "R35_train_sb = sc_R35.inverse_transform(R35_train)\n",
    "R36_train_sb = sc_R36.inverse_transform(R36_train)\n",
    "R37_train_sb = sc_R37.inverse_transform(R37_train)\n",
    "R38_train_sb = sc_R38.inverse_transform(R38_train)\n",
    "R39_train_sb = sc_R39.inverse_transform(R39_train)\n",
    "R40_train_sb = sc_R40.inverse_transform(R40_train)\n",
    "R41_train_sb = sc_R41.inverse_transform(R41_train)\n",
    "R42_train_sb = sc_R42.inverse_transform(R42_train)\n",
    "R43_train_sb = sc_R43.inverse_transform(R43_train)\n",
    "R44_train_sb = sc_R44.inverse_transform(R44_train)\n",
    "R45_train_sb = sc_R45.inverse_transform(R45_train)\n",
    "R46_train_sb = sc_R46.inverse_transform(R46_train)\n",
    "R47_train_sb = sc_R47.inverse_transform(R47_train)\n",
    "Rat_train_sb = sc_Rat.inverse_transform(Rat_train)\n",
    "\n",
    "x_test_sb   = sc_x.inverse_transform(x_test)\n",
    "n1_test_sb  = sc_n1.inverse_transform(n1_test)\n",
    "n2_test_sb  = sc_n2.inverse_transform(n2_test)\n",
    "n3_test_sb  = sc_n3.inverse_transform(n3_test)\n",
    "n4_test_sb  = sc_n4.inverse_transform(n4_test)\n",
    "n5_test_sb  = sc_n5.inverse_transform(n5_test)\n",
    "n6_test_sb  = sc_n6.inverse_transform(n6_test)\n",
    "n7_test_sb  = sc_n7.inverse_transform(n7_test)\n",
    "n8_test_sb  = sc_n8.inverse_transform(n8_test)\n",
    "n9_test_sb  = sc_n9.inverse_transform(n9_test)\n",
    "n10_test_sb = sc_n10.inverse_transform(n10_test)\n",
    "n11_test_sb = sc_n11.inverse_transform(n11_test)\n",
    "n12_test_sb = sc_n12.inverse_transform(n12_test)\n",
    "n13_test_sb = sc_n13.inverse_transform(n13_test)\n",
    "n14_test_sb = sc_n14.inverse_transform(n14_test)\n",
    "n15_test_sb = sc_n15.inverse_transform(n15_test)\n",
    "n16_test_sb = sc_n16.inverse_transform(n16_test)\n",
    "n17_test_sb = sc_n17.inverse_transform(n17_test)\n",
    "n18_test_sb = sc_n18.inverse_transform(n18_test)\n",
    "n19_test_sb = sc_n19.inverse_transform(n19_test)\n",
    "n20_test_sb = sc_n20.inverse_transform(n20_test)\n",
    "n21_test_sb = sc_n21.inverse_transform(n21_test)\n",
    "n22_test_sb = sc_n22.inverse_transform(n22_test)\n",
    "n23_test_sb = sc_n23.inverse_transform(n23_test)\n",
    "n24_test_sb = sc_n24.inverse_transform(n24_test)\n",
    "n25_test_sb = sc_n25.inverse_transform(n25_test)\n",
    "n26_test_sb = sc_n26.inverse_transform(n26_test)\n",
    "n27_test_sb = sc_n27.inverse_transform(n27_test)\n",
    "n28_test_sb = sc_n28.inverse_transform(n28_test)\n",
    "n29_test_sb = sc_n29.inverse_transform(n29_test)\n",
    "n30_test_sb = sc_n30.inverse_transform(n30_test)\n",
    "n31_test_sb = sc_n31.inverse_transform(n31_test)\n",
    "n32_test_sb = sc_n32.inverse_transform(n32_test)\n",
    "n33_test_sb = sc_n33.inverse_transform(n33_test)\n",
    "n34_test_sb = sc_n34.inverse_transform(n34_test)\n",
    "n35_test_sb = sc_n35.inverse_transform(n35_test)\n",
    "n36_test_sb = sc_n36.inverse_transform(n36_test)\n",
    "n37_test_sb = sc_n37.inverse_transform(n37_test)\n",
    "n38_test_sb = sc_n38.inverse_transform(n38_test)\n",
    "n39_test_sb = sc_n39.inverse_transform(n39_test)\n",
    "n40_test_sb = sc_n40.inverse_transform(n40_test)\n",
    "n41_test_sb = sc_n41.inverse_transform(n41_test)\n",
    "n42_test_sb = sc_n42.inverse_transform(n42_test)\n",
    "n43_test_sb = sc_n43.inverse_transform(n43_test)\n",
    "n44_test_sb = sc_n44.inverse_transform(n44_test)\n",
    "n45_test_sb = sc_n45.inverse_transform(n45_test)\n",
    "n46_test_sb = sc_n46.inverse_transform(n46_test)\n",
    "n47_test_sb = sc_n47.inverse_transform(n47_test)\n",
    "\n",
    "nat_test_sb = sc_nat.inverse_transform(nat_test)\n",
    "rho_test_sb = sc_rho.inverse_transform(rho_test)\n",
    "u_test_sb   = sc_u.inverse_transform(u_test)\n",
    "p_test_sb   = sc_p.inverse_transform(p_test)\n",
    "E_test_sb   = sc_E.inverse_transform(E_test)\n",
    "\n",
    "R1_test_sb  = sc_R1.inverse_transform(R1_test)\n",
    "R2_test_sb  = sc_R2.inverse_transform(R2_test)\n",
    "R3_test_sb  = sc_R3.inverse_transform(R3_test)\n",
    "R4_test_sb  = sc_R4.inverse_transform(R4_test)\n",
    "R5_test_sb  = sc_R5.inverse_transform(R5_test)\n",
    "R6_test_sb  = sc_R6.inverse_transform(R6_test)\n",
    "R7_test_sb  = sc_R7.inverse_transform(R7_test)\n",
    "R8_test_sb  = sc_R8.inverse_transform(R8_test)\n",
    "R9_test_sb  = sc_R9.inverse_transform(R9_test)\n",
    "R10_test_sb = sc_R10.inverse_transform(R10_test)\n",
    "R11_test_sb = sc_R11.inverse_transform(R11_test)\n",
    "R12_test_sb = sc_R12.inverse_transform(R12_test)\n",
    "R13_test_sb = sc_R13.inverse_transform(R13_test)\n",
    "R14_test_sb = sc_R14.inverse_transform(R14_test)\n",
    "R15_test_sb = sc_R15.inverse_transform(R15_test)\n",
    "R16_test_sb = sc_R16.inverse_transform(R16_test)\n",
    "R17_test_sb = sc_R17.inverse_transform(R17_test)\n",
    "R18_test_sb = sc_R18.inverse_transform(R18_test)\n",
    "R19_test_sb = sc_R19.inverse_transform(R19_test)\n",
    "R20_test_sb = sc_R20.inverse_transform(R20_test)\n",
    "R21_test_sb = sc_R21.inverse_transform(R21_test)\n",
    "R22_test_sb = sc_R22.inverse_transform(R22_test)\n",
    "R23_test_sb = sc_R23.inverse_transform(R23_test)\n",
    "R24_test_sb = sc_R24.inverse_transform(R24_test)\n",
    "R25_test_sb = sc_R25.inverse_transform(R25_test)\n",
    "R26_test_sb = sc_R26.inverse_transform(R26_test)\n",
    "R27_test_sb = sc_R27.inverse_transform(R27_test)\n",
    "R28_test_sb = sc_R28.inverse_transform(R28_test)\n",
    "R29_test_sb = sc_R29.inverse_transform(R29_test)\n",
    "R30_test_sb = sc_R30.inverse_transform(R30_test)\n",
    "R31_test_sb = sc_R31.inverse_transform(R31_test)\n",
    "R32_test_sb = sc_R32.inverse_transform(R32_test)\n",
    "R33_test_sb = sc_R33.inverse_transform(R33_test)\n",
    "R34_test_sb = sc_R34.inverse_transform(R34_test)\n",
    "R35_test_sb = sc_R35.inverse_transform(R35_test)\n",
    "R36_test_sb = sc_R36.inverse_transform(R36_test)\n",
    "R37_test_sb = sc_R37.inverse_transform(R37_test)\n",
    "R38_test_sb = sc_R38.inverse_transform(R38_test)\n",
    "R39_test_sb = sc_R39.inverse_transform(R39_test)\n",
    "R40_test_sb = sc_R40.inverse_transform(R40_test)\n",
    "R41_test_sb = sc_R41.inverse_transform(R41_test)\n",
    "R42_test_sb = sc_R42.inverse_transform(R42_test)\n",
    "R43_test_sb = sc_R43.inverse_transform(R43_test)\n",
    "R44_test_sb = sc_R44.inverse_transform(R44_test)\n",
    "R45_test_sb = sc_R45.inverse_transform(R45_test)\n",
    "R46_test_sb = sc_R46.inverse_transform(R46_test)\n",
    "R47_test_sb = sc_R47.inverse_transform(R47_test)\n",
    "Rat_test_sb = sc_Rat.inverse_transform(Rat_test)\n",
    "\n",
    "n1_pred_sb  = sc_n1.inverse_transform(n1_pred)\n",
    "n2_pred_sb  = sc_n2.inverse_transform(n2_pred)\n",
    "n3_pred_sb  = sc_n3.inverse_transform(n3_pred)\n",
    "n4_pred_sb  = sc_n4.inverse_transform(n4_pred)\n",
    "n5_pred_sb  = sc_n5.inverse_transform(n5_pred)\n",
    "n6_pred_sb  = sc_n6.inverse_transform(n6_pred)\n",
    "n7_pred_sb  = sc_n7.inverse_transform(n7_pred)\n",
    "n8_pred_sb  = sc_n8.inverse_transform(n8_pred)\n",
    "n9_pred_sb  = sc_n9.inverse_transform(n9_pred)\n",
    "n10_pred_sb = sc_n10.inverse_transform(n10_pred)\n",
    "n11_pred_sb = sc_n11.inverse_transform(n11_pred)\n",
    "n12_pred_sb = sc_n12.inverse_transform(n12_pred)\n",
    "n13_pred_sb = sc_n13.inverse_transform(n13_pred)\n",
    "n14_pred_sb = sc_n14.inverse_transform(n14_pred)\n",
    "n15_pred_sb = sc_n15.inverse_transform(n15_pred)\n",
    "n16_pred_sb = sc_n16.inverse_transform(n16_pred)\n",
    "n17_pred_sb = sc_n17.inverse_transform(n17_pred)\n",
    "n18_pred_sb = sc_n18.inverse_transform(n18_pred)\n",
    "n19_pred_sb = sc_n19.inverse_transform(n19_pred)\n",
    "n20_pred_sb = sc_n20.inverse_transform(n20_pred)\n",
    "n21_pred_sb = sc_n21.inverse_transform(n21_pred)\n",
    "n22_pred_sb = sc_n22.inverse_transform(n22_pred)\n",
    "n23_pred_sb = sc_n23.inverse_transform(n23_pred)\n",
    "n24_pred_sb = sc_n24.inverse_transform(n24_pred)\n",
    "n25_pred_sb = sc_n25.inverse_transform(n25_pred)\n",
    "n26_pred_sb = sc_n26.inverse_transform(n26_pred)\n",
    "n27_pred_sb = sc_n27.inverse_transform(n27_pred)\n",
    "n28_pred_sb = sc_n28.inverse_transform(n28_pred)\n",
    "n29_pred_sb = sc_n29.inverse_transform(n29_pred)\n",
    "n30_pred_sb = sc_n30.inverse_transform(n30_pred)\n",
    "n31_pred_sb = sc_n31.inverse_transform(n31_pred)\n",
    "n32_pred_sb = sc_n32.inverse_transform(n32_pred)\n",
    "n33_pred_sb = sc_n33.inverse_transform(n33_pred)\n",
    "n34_pred_sb = sc_n34.inverse_transform(n34_pred)\n",
    "n35_pred_sb = sc_n35.inverse_transform(n35_pred)\n",
    "n36_pred_sb = sc_n36.inverse_transform(n36_pred)\n",
    "n37_pred_sb = sc_n37.inverse_transform(n37_pred)\n",
    "n38_pred_sb = sc_n38.inverse_transform(n38_pred)\n",
    "n39_pred_sb = sc_n39.inverse_transform(n39_pred)\n",
    "n40_pred_sb = sc_n40.inverse_transform(n40_pred)\n",
    "n41_pred_sb = sc_n41.inverse_transform(n41_pred)\n",
    "n42_pred_sb = sc_n42.inverse_transform(n42_pred)\n",
    "n43_pred_sb = sc_n43.inverse_transform(n43_pred)\n",
    "n44_pred_sb = sc_n44.inverse_transform(n44_pred)\n",
    "n45_pred_sb = sc_n45.inverse_transform(n45_pred)\n",
    "n46_pred_sb = sc_n46.inverse_transform(n46_pred)\n",
    "n47_pred_sb = sc_n47.inverse_transform(n47_pred)\n",
    "nat_pred_sb = sc_nat.inverse_transform(nat_pred)\n",
    "\n",
    "rho_pred_sb = sc_rho.inverse_transform(rho_pred)\n",
    "u_pred_sb   = sc_u.inverse_transform(u_pred)\n",
    "p_pred_sb   = sc_p.inverse_transform(p_pred)\n",
    "E_pred_sb   = sc_E.inverse_transform(E_pred)\n",
    "\n",
    "R1_pred_sb  = sc_R1.inverse_transform(R1_pred)\n",
    "R2_pred_sb  = sc_R2.inverse_transform(R2_pred)\n",
    "R3_pred_sb  = sc_R3.inverse_transform(R3_pred)\n",
    "R4_pred_sb  = sc_R4.inverse_transform(R4_pred)\n",
    "R5_pred_sb  = sc_R5.inverse_transform(R5_pred)\n",
    "R6_pred_sb  = sc_R6.inverse_transform(R6_pred)\n",
    "R7_pred_sb  = sc_R7.inverse_transform(R7_pred)\n",
    "R8_pred_sb  = sc_R8.inverse_transform(R8_pred)\n",
    "R9_pred_sb  = sc_R9.inverse_transform(R9_pred)\n",
    "R10_pred_sb = sc_R10.inverse_transform(R10_pred)\n",
    "R11_pred_sb = sc_R11.inverse_transform(R11_pred)\n",
    "R12_pred_sb = sc_R12.inverse_transform(R12_pred)\n",
    "R13_pred_sb = sc_R13.inverse_transform(R13_pred)\n",
    "R14_pred_sb = sc_R14.inverse_transform(R14_pred)\n",
    "R15_pred_sb = sc_R15.inverse_transform(R15_pred)\n",
    "R16_pred_sb = sc_R16.inverse_transform(R16_pred)\n",
    "R17_pred_sb = sc_R17.inverse_transform(R17_pred)\n",
    "R18_pred_sb = sc_R18.inverse_transform(R18_pred)\n",
    "R19_pred_sb = sc_R19.inverse_transform(R19_pred)\n",
    "R20_pred_sb = sc_R20.inverse_transform(R20_pred)\n",
    "R21_pred_sb = sc_R21.inverse_transform(R21_pred)\n",
    "R22_pred_sb = sc_R22.inverse_transform(R22_pred)\n",
    "R23_pred_sb = sc_R23.inverse_transform(R23_pred)\n",
    "R24_pred_sb = sc_R24.inverse_transform(R24_pred)\n",
    "R25_pred_sb = sc_R25.inverse_transform(R25_pred)\n",
    "R26_pred_sb = sc_R26.inverse_transform(R26_pred)\n",
    "R27_pred_sb = sc_R27.inverse_transform(R27_pred)\n",
    "R28_pred_sb = sc_R28.inverse_transform(R28_pred)\n",
    "R29_pred_sb = sc_R29.inverse_transform(R29_pred)\n",
    "R30_pred_sb = sc_R30.inverse_transform(R30_pred)\n",
    "R31_pred_sb = sc_R31.inverse_transform(R31_pred)\n",
    "R32_pred_sb = sc_R32.inverse_transform(R32_pred)\n",
    "R33_pred_sb = sc_R33.inverse_transform(R33_pred)\n",
    "R34_pred_sb = sc_R34.inverse_transform(R34_pred)\n",
    "R35_pred_sb = sc_R35.inverse_transform(R35_pred)\n",
    "R36_pred_sb = sc_R36.inverse_transform(R36_pred)\n",
    "R37_pred_sb = sc_R37.inverse_transform(R37_pred)\n",
    "R38_pred_sb = sc_R38.inverse_transform(R38_pred)\n",
    "R39_pred_sb = sc_R39.inverse_transform(R39_pred)\n",
    "R40_pred_sb = sc_R40.inverse_transform(R40_pred)\n",
    "R41_pred_sb = sc_R41.inverse_transform(R41_pred)\n",
    "R42_pred_sb = sc_R42.inverse_transform(R42_pred)\n",
    "R43_pred_sb = sc_R43.inverse_transform(R43_pred)\n",
    "R44_pred_sb = sc_R44.inverse_transform(R44_pred)\n",
    "R45_pred_sb = sc_R45.inverse_transform(R45_pred)\n",
    "R46_pred_sb = sc_R46.inverse_transform(R46_pred)\n",
    "R47_pred_sb = sc_R47.inverse_transform(R47_pred)\n",
    "Rat_pred_sb = sc_Rat.inverse_transform(Rat_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "# https://medium.com/@1522933668924/using-matplotlib-in-jupyter-notebooks-comparing-methods-and-some-tips-python-c38e85b40ba1\n",
    "\n",
    "# Plot Nci\n",
    "#plt.plot(x_test_sb, n1_pred_sb, 'o', color='black', label='NN', linewidth=2, markersize=5, fillstyle='none')\n",
    "#plt.plot(x_test_sb, n1_test_sb, 'o', color='red',   label='Exact', markersize=4)\n",
    "plt.plot(x_test_sb, n3_pred_sb, 'o', color='black', label='NN, i=3', linewidth=4, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, n3_test_sb, 'o', color='red',   label='Exact, i=3', markersize=4)\n",
    "plt.plot(x_test_sb, n6_pred_sb, 'o', color='black', label='NN, i=6', linewidth=4, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, n6_test_sb, 'o', color='blue',   label='Exact, i=6', markersize=4)\n",
    "plt.plot(x_test_sb, n9_pred_sb, 'o', color='black', label='NN, i=9', linewidth=4, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, n9_test_sb, 'o', color='green',   label='Exact, i=9', markersize=4)\n",
    "plt.plot(x_test_sb, n12_pred_sb, 'o', color='black', label='NN, i=12', linewidth=4, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, n12_test_sb, 'o', color='magenta',   label='Exact, i=12', markersize=4)\n",
    "plt.plot(x_test_sb, n15_pred_sb, 'o', color='black', label='NN, i=15', linewidth=4, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, n15_test_sb, 'o', color='yellow',   label='Exact, i=15', markersize=4)\n",
    "#plt.title('Comparison of NN and Exact solution for Molecular Number Density')\n",
    "plt.xlabel('X [mm]')\n",
    "plt.ylabel('$n_{ci}$ $[m^-3]$')\n",
    "plt.legend()\n",
    "plt.tight_layout()\n",
    "savefig('./figures/Nci', crop = False)\n",
    "plt.show()\n",
    "\n",
    "# Plot Nat\n",
    "plt.plot(x_test_sb, nat_pred_sb, 'o', color='black', label='NN', linewidth=2, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, nat_test_sb, 'o', color='red',   label='Exact', markersize=4)\n",
    "#plt.title('Comparison of NN and Exact solution for Atomic Number Density')\n",
    "plt.xlabel('X [mm]')\n",
    "plt.ylabel('$n_{at}$ $[m^-3]$')\n",
    "plt.legend()\n",
    "plt.tight_layout()\n",
    "savefig('./figures/Nat', crop = False)\n",
    "plt.show()\n",
    "\n",
    "# Plot RHO\n",
    "plt.plot(x_test_sb, rho_pred_sb, 'o', color='black', label='NN', linewidth=2, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, rho_test_sb, 'o', color='red',   label='Exact', markersize=4)\n",
    "#plt.title('Comparison of NN and Exact solution for Density')\n",
    "plt.xlabel('X [mm]')\n",
    "plt.ylabel(r'$\\rho$ $[kg/m^3]$')\n",
    "plt.legend()\n",
    "plt.tight_layout()\n",
    "savefig('./figures/RHO', crop = False)\n",
    "plt.show()\n",
    "\n",
    "# Plot P\n",
    "plt.plot(x_test_sb, p_pred_sb, 'o', color='black', label='NN', linewidth=2, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, p_test_sb, 'o', color='red',   label='Exact', markersize=4)\n",
    "#plt.title('Comparison of NN and Exact solution for Pressure')\n",
    "plt.xlabel('X [mm]')\n",
    "plt.ylabel('P [Pa]')\n",
    "plt.legend()\n",
    "plt.tight_layout()\n",
    "savefig('./figures/P', crop = False)\n",
    "plt.show()\n",
    "\n",
    "# Plot U\n",
    "plt.plot(x_test_sb, u_pred_sb, 'o', color='black', label='NN', linewidth=2, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, u_test_sb, 'o', color='red',   label='Exact', markersize=4)\n",
    "#plt.title('Comparison of NN and Exact solution for Velocity')\n",
    "plt.xlabel('X [mm]')\n",
    "plt.ylabel('U [m/s]')\n",
    "plt.legend()\n",
    "plt.tight_layout()\n",
    "savefig('./figures/U', crop = False)\n",
    "plt.show()\n",
    "\n",
    "# Plot E\n",
    "plt.plot(x_test_sb, E_pred_sb, 'o', color='black', label='NN', linewidth=2, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, E_test_sb, 'o', color='red',   label='Exact', markersize=4)\n",
    "#plt.title('Comparison of NN and Exact solution for Energy')\n",
    "plt.xlabel('X [mm]')\n",
    "plt.ylabel('E [eV]')\n",
    "plt.legend()\n",
    "plt.tight_layout()\n",
    "savefig('./figures/E', crop = False)\n",
    "plt.show()\n",
    "\n",
    "# Plot Rci\n",
    "#plt.plot(x_test_sb, Rci_pred_sb[:,1:46:2], 'o', color='black', label='NN', linewidth=2, markersize=5, fillstyle='none')\n",
    "#plt.plot(x_test_sb, Rci_test_sb[:,1:46:2], 'o', color='red',   label='Exact', markersize=4)\n",
    "plt.plot(x_test_sb, R1_pred_sb, 'o', color='black', label='NN', linewidth=2, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, R1_test_sb, 'o', color='red',   label='Exact', markersize=4)\n",
    "plt.title('Comparison of NN and Exact solution for $R_{ci}$')\n",
    "plt.xlabel('X [mm]')\n",
    "plt.ylabel('$R_{ci}$ $[J/m^3/s]$')\n",
    "#plt.legend()\n",
    "plt.tight_layout()\n",
    "savefig('./figures/Rci', crop = False)\n",
    "plt.show()\n",
    "\n",
    "# Plot Rat\n",
    "plt.plot(x_test_sb, Rat_pred_sb, 'o', color='black', label='NN', linewidth=2, markersize=5, fillstyle='none')\n",
    "plt.plot(x_test_sb, Rat_test_sb, 'o', color='red',   label='Exact', markersize=4 )\n",
    "#plt.title('Comparison of NN and Exact solution for $R_{at}$')\n",
    "plt.xlabel('X [mm]')\n",
    "plt.ylabel(r'$R_{at}$ $[J/m^3/s]$')\n",
    "plt.legend()\n",
    "plt.tight_layout()\n",
    "savefig('./figures/Rat', crop='false')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
