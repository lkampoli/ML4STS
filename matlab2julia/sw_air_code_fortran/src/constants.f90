
 Module constants
 use kind_module, only: wp
 implicit none

 public

 real(WP), parameter :: Pi               = acos(-1.0_WP) !< Pi number [-]
 real(WP), parameter :: FourPiPi         = 4.0_WP * Pi * Pi
 real(WP), parameter :: TwoPi            = 2.0_WP * Pi
 real(WP), parameter :: FourPi           = 4.0_WP * Pi
 real(WP), parameter :: Degree_To_Radian = Pi / 180.0_WP
 real(WP), parameter :: Radian_To_Degree = 180.0_WP / Pi
 real(WP), parameter :: log2             = log(2.0_WP)
 real(WP), parameter :: Zero             = 0.0_WP
 real(WP), parameter :: One              = 1.0_WP
 real(WP), parameter :: Two              = 2.0_WP
 real(WP), parameter :: Three            = 3.0_WP
 real(WP), parameter :: Four             = 4.0_WP
 real(WP), parameter :: Five             = 5.0_WP
 real(WP), parameter :: Six              = 6.0_WP
 real(WP), parameter :: Seven            = 7.0_WP
 real(WP), parameter :: Eight            = 8.0_WP
 real(WP), parameter :: Nine             = 9.0_WP
 real(WP), parameter :: Ten              = 10.0_WP
 real(WP), parameter :: Twenty           = 20.0_WP
 real(WP), parameter :: Thirty           = 30.0_WP
 real(WP), parameter :: Forty            = 40.0_WP
 real(WP), parameter :: Fifty            = 50.0_WP
 real(WP), parameter :: Sixty            = 60.0_WP
 real(WP), parameter :: Seventy          = 70.0_WP
 real(WP), parameter :: Eighty           = 80.0_WP
 real(WP), parameter :: Ninety           = 90.0_WP
 real(WP), parameter :: Hundred          = 100.0_WP
 real(WP), parameter :: TwoHundred       = 200.0_WP
 real(WP), parameter :: Thousand         = 1000.0_WP

 real(WP), parameter :: f_1o2            = 0.5_WP
 real(WP), parameter :: f_1o3            = 1.0_WP / 3.0_WP
 real(WP), parameter :: f_1o4            = 0.25_WP
 real(WP), parameter :: f_1o5            = 0.2_WP
 real(WP), parameter :: f_1o6            = 1.0_WP / 6.0_WP
 real(WP), parameter :: f_1o8            = 0.125_WP
 real(WP), parameter :: f_1o12           = 1.0_WP / 12.0_WP
 real(WP), parameter :: f_1o16           = 1.0_WP / 16.0_WP
 real(WP), parameter :: f_1o20           = 0.05_WP
 real(WP), parameter :: f_2o3            = 2.0_WP / 3.0_WP
 real(WP), parameter :: f_3o2            = 1.5_WP
 real(WP), parameter :: f_3o4            = 3.0_WP / 4.0_WP
 real(WP), parameter :: f_4o3            = 4.0_WP / 3.0_WP
 real(WP), parameter :: f_4o5            = 0.8_WP
 real(WP), parameter :: f_5o2            = 2.5_WP
 real(WP), parameter :: f_5o3            = 5.0_WP / 3.0_WP
 real(WP), parameter :: f_8o3            = 8.0_WP / 3.0_WP
 real(WP), parameter :: f_7o5            = 1.4_WP
 real(WP), parameter :: f_7o2            = 3.50_WP
 real(WP), parameter :: f_15o4           = 3.75_WP
 real(WP), parameter :: f_16o5           = 3.2_WP
 real(WP), parameter :: f_2oPi           = 2.0_WP / Pi

 real(WP), parameter :: sqrt8            = sqrt(Eight)

 real(WP), parameter :: c = 2.99e8_WP
 real(WP), parameter :: R = 8.3145_WP
 real(WP), parameter :: h = 6.6261e-34_WP
 real(WP), parameter :: h_bar = h/TwoPi
 real(WP), parameter :: k = 1.3807e-23_WP
 real(WP), parameter :: N_a = 6.0221e23_WP
 real(WP), parameter :: tol = 1e-4_WP
 real(WP), parameter :: x_w = Two !m
 real(WP), parameter :: gamma0 = 1.40_WP

 real(WP), parameter :: v0 = 3870.0_WP

 ! switch
 integer, parameter :: sw_o = 1
!integer, parameter :: sw_o = 2

 character(len=*), parameter :: sw_arr = "Park"
!character(len=*), parameter :: sw_arr = "Scanlon"

 character(len=*), parameter :: sw_u = "D/6k"
!character(len=*), parameter :: sw_u = "3T"
!character(len=*), parameter :: sw_u = "Inf"

 character(len=*), parameter :: sw_z = "Savelev"
!character(len=*), parameter :: sw_z = "Starik"
!character(len=*), parameter :: sw_z = "Stellar"

 real(WP), parameter, dimension(3) :: om_e   = [235857.0_WP, 158019.0_WP, 190420.0_WP]
 real(WP), parameter, dimension(3) :: om_x_e = [1432.0_WP, 1198.0_WP, 1407.5_WP]
 real(WP), parameter, dimension(3) :: Be     = [1.998_WP, 1.4377_WP, 1.6720_WP] * Hundred

 integer, parameter, dimension(3) :: l = [47, 36, 39]
!integer, parameter, dimension(3) :: l = [33, 26, 28]

 integer, parameter :: l1 = l(1)
 integer, parameter :: l2 = l(2)
 integer, parameter :: l3 = l(3)
 integer, parameter :: lall = l1+l2+l3
 integer, parameter :: Lmax1 = l1-1
 integer, parameter :: Lmax2 = l2-1
 integer, parameter :: Lmax3 = l3-1

 real(WP), parameter :: Torr  = 133.322_WP
 real(WP), parameter :: p0    = 2.25_WP*Torr ! Pa
 real(WP), parameter :: T0    = 300._WP      ! K
 real(WP), parameter :: f_1oT0= One/T0
 real(WP), parameter :: Tv0n2 = T0           ! K
 real(WP), parameter :: Tv0o2 = T0           ! K
 real(WP), parameter :: Tv0no = T0           ! K

 real(WP), parameter :: f_1oTv0n2k = One/(Tv0n2*k)
 real(WP), parameter :: f_1oTv0o2k = One/(Tv0o2*k)
 real(WP), parameter :: f_1oTv0nok = One/(Tv0no*k)

 real(WP), parameter :: kT0 = k*T0
 real(WP), parameter :: f_1okT0 = One/kT0

 real(WP), parameter :: alphaVV = 4e10
 real(WP), parameter :: Svv     = f_1o16

 real(WP), parameter, dimension(3) :: D = [113200.0_WP, 59500.0_WP, 75500.0_WP]

 real(WP), parameter :: efn_b = f_1o2*D(1)*f_1oT0
 real(WP), parameter :: efo_b = f_1o2*D(2)*f_1oT0
 real(WP), parameter :: efno_b = efn_b+efo_b-D(3)*f_1oT0

 real(WP), parameter, dimension(3,5) :: CA =                                            &
 reshape([1.162385214460072e-08_WP, 3.321100612743063e-09_WP, 8.302751531857657e-15_WP, &
 1.162385214460072e-08_WP, 3.321100612743063e-09_WP, 8.302751531857657e-15_WP,          &
 1.162385214460072e-08_WP, 3.321100612743063e-09_WP, 1.826605337008685e-13_WP,          &
 4.981650919114595e-08_WP, 1.660550306371531e-08_WP, 1.826605337008685e-13_WP,          &
 4.981650919114595e-08_WP, 1.660550306371531e-08_WP, 1.826605337008685e-13_WP], [3,5])

 real(WP), parameter, dimension(3,5) :: nA =                            &
 reshape([-1.600000000000000e+00_WP, -1.500000000000000e+00_WP, Zero,   &
 -1.600000000000000e+00_WP, -1.500000000000000e+00_WP, Zero,            &
 -1.600000000000000e+00_WP, -1.500000000000000e+00_WP, Zero,            &
 -1.600000000000000e+00_WP, -1.500000000000000e+00_WP, Zero,            &
 -1.600000000000000e+00_WP, -1.500000000000000e+00_WP, Zero], [3,5])

 real(WP), parameter, dimension(2) :: CAZ = [1.062740000000000e-12_WP, 1.394850000000000e-17_WP]
 real(WP), parameter, dimension(2) :: nAZ = [-1.0_WP, 0.0_WP]
 real(WP), parameter, dimension(2) :: EaZ = [5.297560000000000e-19_WP, 2.685370000000000e-19_WP]

 real(WP), parameter, dimension(5) :: ef = [0.0_WP, 0.0_WP, (0.5_WP*(D(1)+D(2))-D(3)),0.5_WP*D(1),0.5_WP*D(2)] * k

 real(WP), parameter, dimension(5) :: mu = [28, 32, 30, 14, 16] * 1e-3_WP ! kg/mol
 real(WP), parameter, dimension(5) :: m  = mu / N_a ! N2-O2-NO-N-O
 real(WP)                          :: tMass != sum(m)
 real(WP), parameter, dimension(3) :: re = [1.097, 1.207, 1.151] * 1e-10_WP ! N2-O2-NO

 real(WP), parameter, dimension(3) :: osc_mass = [0.5_WP*m(4), 0.5_WP*m(5), m(4)*m(5)/(m(4)+m(5))]
 real(WP), parameter, dimension(3,2) :: ram_masses = reshape([0.5_WP, 0.5_WP, 0.4668_WP, 0.5_WP, 0.5_WP, 0.5332_WP], [3,2])

 real(WP), dimension(4) :: us_95_5_exp  = [3.87, 3.49, 3.15, 2.97]
 real(WP), dimension(4) :: us_78_22_exp = [3.85, 3.52, 3.26, 2.99]
 real(WP), dimension(4) :: us_60_40_exp = [3.85, 3.47, 3.24, 3.06]

 real(WP), dimension(3) :: incon = [0.95_WP,  0.05_WP,  3.87_WP]
!real(WP), dimension(3) :: incon = [0.777, 0.223, 3.85]
!real(WP), dimension(3) :: incon = [0.6,   0.4,   3.85]

 ! N2-N2, O2-O2, NO-NO, N-N, O-O
 real(WP), parameter, dimension(5) :: R0 = [3.621e-10_WP, 3.458e-10_WP, 3.47e-10_WP, 3.298e-10_WP, 2.75e-10_WP] ! m

!N2-N2, O2-O2, NO-NO, N-N, O-O
 real(WP), parameter, dimension(5) :: EM = [97.5_WP, 107.4_WP, 119._WP, 71.4_WP, 80._WP] ! K

 real(WP), parameter, dimension(3,5) :: rO = reshape([3.621000000000000e-10_WP, &
                                                      3.539500000000000e-10_WP, &
                                                      3.545500000000000e-10_WP, &
                                                      3.539500000000000e-10_WP, &
                                                      3.458000000000000e-10_WP, &
                                                      3.464000000000000e-10_WP, &
                                                      3.545500000000000e-10_WP, &
                                                      3.464000000000000e-10_WP, &
                                                      3.470000000000000e-10_WP, &
                                                      3.459500000000000e-10_WP, &
                                                      3.378000000000000e-10_WP, &
                                                      3.384000000000000e-10_WP, &
                                                      3.185500000000000e-10_WP, &
                                                      3.104000000000000e-10_WP, &
                                                      3.110000000000000e-10_WP], [3,5])
 real(WP), parameter :: n0 = p0/(k*T0)
 real(WP), parameter :: sigma0 = Pi*r0(1)*r0(1)
 real(WP), parameter :: lambda0 = One/(sqrt(Two)*n0*sigma0)
 real(WP), parameter :: Delta = lambda0
 real(WP), parameter :: Deltan0v0 = Delta*n0/v0

 real(WP), parameter, dimension(3) :: sigma   = [2, 2, 1]
 real(WP), parameter, dimension(3) :: Theta_r = Be*h*c/k

 real(WP), parameter, dimension(5,3) :: fho_data_n2 = reshape([3.9e+10_WP, &
                                                               3.9e+10_WP, &
                                                               4.0e+10_WP, &
                                                               4.6e+10_WP, &
                                                               7.3e+10_WP, &
                                                               1.3807e-23_WP, &
                                                               8.2842e-23_WP, &
                                                               2.7614e-23_WP, &
                                                               1.3807e-23_WP, &
                                                               6.903499999999999e-21_WP, &
                                                               9.0e-01_WP, &
                                                               9.5e-01_WP, &
                                                               7.5e-01_WP, &
                                                               9.9e-01_WP, &
                                                               1.75e-01_WP], [5,3])

 real(WP), parameter, dimension(5,3) :: fho_data_o2 = reshape([4.100000000000000e+10_WP, &
                                                               4.300000000000000e+10_WP, &
                                                               4.100000000000000e+10_WP, &
                                                               7.300000000000000e+10_WP, &
                                                               2.600000000000000e+10_WP, &
                                                               2.071050000000000e-21_WP, &
                                                               5.522799999999999e-22_WP, &
                                                               2.071050000000000e-21_WP, &
                                                               1.380700000000000e-22_WP, &
                                                               2.347190000000000e-19_WP, &
                                                               3.333330000000000e-01_WP, &
                                                               9.900000000000000e-01_WP, &
                                                               3.333330000000000e-01_WP, &
                                                               2.500000000000000e-01_WP, &
                                                               2.000000000000000e-01_WP], [5,3])

 real(WP), parameter, dimension(5,3) :: fho_data_no = reshape([4.400000000000000e+10_WP, &
                                                               6.750000000000000e+10_WP, &
                                                               6.250000000000000e+10_WP, &
                                                               5.000000000000000e+10_WP, &
                                                               7.900000000000000e+10_WP, &
                                                               2.761400000000000e-22_WP, &
                                                               2.071050000000000e-20_WP, &
                                                               6.213150000000000e-20_WP, &
                                                               2.761400000000000e-21_WP, &
                                                               2.209120000000000e-19_WP, &
                                                               9.000000000000000e-01_WP, &
                                                               2.000000000000000e-01_WP, &
                                                               3.000000000000000e-02_WP, &
                                                               3.183000000000000e-01_WP, &
                                                               6.000000000000000e-02_WP], [5,3])

 real(WP), parameter, dimension(5,3,3) :: FHO_data = reshape([fho_data_n2, fho_data_o2, fho_data_no], [5,3,3])

 real(WP), parameter, dimension(5,2) :: vss_data_n2 = reshape([4.040000000000000e-10_WP, &
                                                               3.604000000000000e-10_WP, &
                                                               4.391000000000000e-10_WP, &
                                                               4.088000000000000e-10_WP, &
                                                               3.222000000000000e-10_WP, &
                                                               6.860000000000001e-01_WP, &
                                                               7.030000000000000e-01_WP, &
                                                               7.560000000000000e-01_WP, &
                                                               7.620000000000000e-01_WP, &
                                                               7.020000000000000e-01_WP], [5,2])

 real(WP), parameter, dimension(5,2) :: vss_data_o2 = reshape([3.604000000000000e-10_WP, &
                                                               3.896000000000000e-10_WP, &
                                                               4.054000000000000e-10_WP, &
                                                               3.721000000000000e-10_WP, &
                                                               3.734000000000000e-10_WP, &
                                                               7.030000000000000e-01_WP, &
                                                               7.000000000000000e-01_WP, &
                                                               7.180000000000000e-01_WP, &
                                                               7.570000000000000e-01_WP, &
                                                               7.600000000000000e-01_WP], [5,2])

 real(WP), parameter, dimension(5,2) :: vss_data_no = reshape([4.391000000000000e-10_WP, &
                                                               4.054000000000000e-10_WP, &
                                                               4.218000000000000e-10_WP, &
                                                               4.028000000000000e-10_WP, &
                                                               3.693000000000000e-10_WP, &
                                                               7.560000000000000e-01_WP, &
                                                               7.180000000000000e-01_WP, &
                                                               7.370000000000000e-01_WP, &
                                                               7.880000000000000e-01_WP, &
                                                               7.520000000000000e-01_WP], [5,2])

 real(WP), parameter, dimension(5,2,3) :: vss_data = reshape([vss_data_n2,vss_data_o2,vss_data_no], [5,2,3])

 real(WP), dimension(lall+4) :: Brhs = 0.0_WP

 real*8, dimension(445) :: xstep = [ 0.0,                  &
                                     0.000503748511819989, &
                                     0.00100749702363998, &
                                     0.00151124553545997, &
                                     0.00372651448139587, &
                                     0.00594178342733178, &
                                     0.00815705237326769, &
                                     0.0103723213192036, &
                                     0.0181114743623137, &
                                     0.0258506274054237, &
                                     0.0335897804485338, &
                                     0.0413289334916439, &
                                     0.0606050853086290, &
                                     0.0798812371256141, &
                                     0.0991573889425993, &
                                     0.118433540759584, &
                                     0.137709692576570, &
                                     0.175460765392189, &
                                     0.213211838207809, &
                                     0.250962911023428, &
                                     0.288713983839048, &
                                     0.326465056654668, &
                                     0.364216129470287, &
                                     0.426977120570623, &
                                     0.489738111670959, &
                                     0.552499102771295, &
                                     0.615260093871630, &
                                     0.678021084971966, &
                                     0.740782076072302, &
                                     0.803543067172638, &
                                     0.891339440653622, &
                                     0.979135814134605, &
                                     1.06693218761559, &
                                     1.15472856109657, &
                                     1.24252493457756, &
                                     1.33032130805854, &
                                     1.41811768153952, &
                                     1.51461010858151, &
                                     1.61110253562350, &
                                     1.70759496266548, &
                                     1.80408738970747, &
                                     1.90057981674946, &
                                     1.99707224379144, &
                                     2.09356467083343, &
                                     2.20779711349503, &
                                     2.32202955615664, &
                                     2.43626199881824, &
                                     2.55049444147985, &
                                     2.66472688414145, &
                                     2.77895932680306, &
                                     2.89319176946466, &
                                     3.02771919428138, &
                                     3.16224661909810, &
                                     3.29677404391482, &
                                     3.43130146873154, &
                                     3.56582889354826, &
                                     3.70035631836498, &
                                     3.83488374318170, &
                                     3.99237898422704, &
                                     4.14987422527238, &
                                     4.30736946631772, &
                                     4.46486470736305, &
                                     4.62235994840839, &
                                     4.77985518945372, &
                                     4.93735043049906, &
                                     5.12386673897250, &
                                     5.31038304744594, &
                                     5.49689935591938, &
                                     5.68341566439282, &
                                     5.86993197286626, &
                                     6.05644828133969, &
                                     6.24296458981313, &
                                     6.46612095798259, &
                                     6.68927732615205, &
                                     6.91243369432151, &
                                     7.13559006249097, &
                                     7.35874643066042, &
                                     7.58190279882988, &
                                     7.80505916699934, &
                                     8.07515016808644, &
                                     8.34524116917353, &
                                     8.61533217026063, &
                                     8.88542317134773, &
                                     9.15551417243483, &
                                     9.42560517352192, &
                                     9.69569617460902, &
                                     10.0269690281870, &
                                     10.3582418817650, &
                                     10.6895147353430, &
                                     11.0207875889210, &
                                     11.3520604424990, &
                                     11.6833332960769, &
                                     12.0146061496549, &
                                     12.4244599062524, &
                                     12.8343136628498, &
                                     13.2441674194472, &
                                     13.6540211760447, &
                                     14.0638749326421, &
                                     14.4737286892395, &
                                     14.8835824458370, &
                                     15.3792679921563, &
                                     15.8749535384757, &
                                     16.3706390847951, &
                                     16.8663246311145, &
                                     17.3620101774339, &
                                     17.8576957237533, &
                                     18.3533812700727, &
                                     18.9570145389207, &
                                     19.5606478077687, &
                                     20.1642810766167, &
                                     20.7679143454647, &
                                     21.3715476143127, &
                                     21.9751808831607, &
                                     22.5788141520087, &
                                     23.3074009365676, &
                                     24.0359877211265, &
                                     24.7645745056854, &
                                     25.4931612902443, &
                                     26.2217480748032, &
                                     26.9503348593621, &
                                     27.6789216439210, &
                                     28.5062948536855, &
                                     29.3336680634499, &
                                     30.1610412732144, &
                                     30.9884144829788, &
                                     31.8157876927433, &
                                     32.6431609025077, &
                                     33.4705341122722, &
                                     34.4141947471313, &
                                     35.3578553819903, &
                                     36.3015160168494, &
                                     37.2451766517085, &
                                     38.1888372865675, &
                                     39.1324979214266, &
                                     40.0761585562857, &
                                     41.1641661747497, &
                                     42.2521737932137, &
                                     43.3401814116777, &
                                     44.4281890301418, &
                                     45.5161966486058, &
                                     46.6042042670698, &
                                     47.6922118855338, &
                                     48.9574281502675, &
                                     50.2226444150012, &
                                     51.4878606797349, &
                                     52.7530769444686, &
                                     54.0182932092023, &
                                     55.2835094739360, &
                                     56.5487257386697, &
                                     57.9682616281837, &
                                     59.3877975176977, &
                                     60.8073334072117, &
                                     62.2268692967257, &
                                     63.6464051862397, &
                                     65.0659410757536, &
                                     66.4854769652676, &
                                     68.1512664569767, &
                                     69.8170559486858, &
                                     71.4828454403949, &
                                     73.1486349321040, &
                                     74.8144244238131, &
                                     76.4802139155222, &
                                     78.1460034072314, &
                                     80.0514681984879, &
                                     81.9569329897444, &
                                     83.8623977810010, &
                                     85.7678625722575, &
                                     87.6733273635140, &
                                     89.5787921547706, &
                                     91.4842569460271, &
                                     93.1228706026688, &
                                     94.7614842593105, &
                                     96.4000979159523, &
                                     98.0387115725940, &
                                     99.6773252292357, &
                                     101.315938885877, &
                                     103.257697469557, &
                                     105.199456053237, &
                                     107.141214636917, &
                                     109.082973220597, &
                                     111.024731804277, &
                                     112.966490387956, &
                                     115.264474402809, &
                                     117.562458417662, &
                                     119.860442432515, &
                                     122.158426447368, &
                                     124.456410462221, &
                                     126.754394477074, &
                                     129.052378491927, &
                                     131.827918054822, &
                                     134.603457617717, &
                                     137.378997180612, &
                                     140.154536743507, &
                                     142.930076306402, &
                                     145.705615869297, &
                                     148.481155432192, &
                                     152.173604693375, &
                                     155.866053954558, &
                                     159.558503215741, &
                                     163.250952476924, &
                                     166.943401738107, &
                                     170.635850999291, &
                                     174.328300260474, &
                                     178.524316776210, &
                                     182.720333291946, &
                                     186.916349807682, &
                                     191.112366323418, &
                                     195.308382839154, &
                                     199.504399354890, &
                                     203.700415870627, &
                                     207.321517345517, &
                                     210.942618820408, &
                                     214.563720295298, &
                                     218.184821770189, &
                                     221.805923245080, &
                                     225.427024719970, &
                                     229.652128856613, &
                                     233.877232993256, &
                                     238.102337129899, &
                                     242.327441266542, &
                                     246.552545403185, &
                                     250.777649539828, &
                                     256.065631184732, &
                                     261.353612829637, &
                                     266.641594474542, &
                                     271.929576119447, &
                                     277.217557764352, &
                                     282.505539409257, &
                                     287.793521054162, &
                                     294.718005535564, &
                                     301.642490016966, &
                                     308.566974498368, &
                                     315.491458979770, &
                                     322.415943461172, &
                                     329.340427942574, &
                                     336.264912423976, &
                                     343.588388962248, &
                                     350.911865500519, &
                                     358.235342038790, &
                                     365.558818577061, &
                                     372.882295115333, &
                                     380.205771653604, &
                                     387.529248191875, &
                                     395.215059994401, &
                                     402.900871796927, &
                                     410.586683599453, &
                                     418.272495401980, &
                                     425.958307204506, &
                                     433.644119007032, &
                                     441.329930809558, &
                                     452.192622874570, &
                                     463.055314939582, &
                                     473.918007004594, &
                                     484.780699069605, &
                                     495.643391134617, &
                                     506.506083199629, &
                                     517.368775264641, &
                                     530.280665654104, &
                                     543.192556043568, &
                                     556.104446433031, &
                                     569.016336822495, &
                                     581.928227211958, &
                                     594.840117601422, &
                                     607.752007990885, &
                                     623.290279158704, &
                                     638.828550326522, &
                                     654.366821494341, &
                                     669.905092662159, &
                                     685.443363829978, &
                                     700.981634997796, &
                                     716.519906165615, &
                                     737.862545224811, &
                                     759.205184284007, &
                                     780.547823343202, &
                                     801.890462402398, &
                                     823.233101461594, &
                                     844.575740520790, &
                                     865.918379579986, &
                                     887.261018639182, &
                                     908.603657698378, &
                                     929.946296757574, &
                                     951.315014714553, &
                                     972.683732671532, &
                                     994.052450628511, &
                                     1015.42116858549, &
                                     1036.78988654247, &
                                     1058.15860449945, &
                                     1079.52732245643, &
                                     1106.44879325506, &
                                     1133.37026405370, &
                                     1160.29173485233, &
                                     1187.21320565097, &
                                     1214.13467644960, &
                                     1241.05614724824, &
                                     1267.97761804687, &
                                     1300.99628784376, &
                                     1334.01495764065, &
                                     1367.03362743754, &
                                     1400.05229723443, &
                                     1433.07096703132, &
                                     1466.08963682821, &
                                     1526.11981646154, &
                                     1586.14999609487, &
                                     1646.18017572821, &
                                     1706.21035536154, &
                                     1766.24053499487, &
                                     1826.27071462821, &
                                     1916.43796306854, &
                                     2006.60521150887, &
                                     2096.77245994921, &
                                     2186.93970838954, &
                                     2277.10695682987, &
                                     2367.27420527020, &
                                     2488.99598110754, &
                                     2610.71775694489, &
                                     2732.43953278223, &
                                     2854.16130861957, &
                                     2975.88308445691, &
                                     3097.60486029426, &
                                     3243.31995317322, &
                                     3389.03504605219, &
                                     3534.75013893116, &
                                     3680.46523181012, &
                                     3826.18032468909, &
                                     3971.89541756805, &
                                     4117.61051044702, &
                                     4292.68608403317, &
                                     4467.76165761931, &
                                     4642.83723120545, &
                                     4817.91280479160, &
                                     4992.98837837774, &
                                     5168.06395196389, &
                                     5343.13952555003, &
                                     5539.66393815707, &
                                     5736.18835076411, &
                                     5932.71276337116, &
                                     6129.23717597820, &
                                     6325.76158858524, &
                                     6522.28600119228, &
                                     6718.81041379932, &
                                     6915.33482640637, &
                                     7111.85923901341, &
                                     7308.38365162045, &
                                     7504.90806422749, &
                                     7715.97548023553, &
                                     7927.04289624356, &
                                     8138.11031225159, &
                                     8349.17772825963, &
                                     8560.24514426766, &
                                     8771.31256027569, &
                                     8982.37997628372, &
                                     9204.13750737745, &
                                     9425.89503847117, &
                                     9647.65256956489, &
                                     9869.41010065861, &
                                     10091.1676317523, &
                                     10312.9251628461, &
                                     10534.6826939398, &
                                     10809.5005563834, &
                                     11084.3184188271, &
                                     11359.1362812707, &
                                     11633.9541437144, &
                                     11908.7720061580, &
                                     12183.5898686017, &
                                     12458.4077310453, &
                                     12778.5225473993, &
                                     13098.6373637533, &
                                     13418.7521801073, &
                                     13738.8669964613, &
                                     14058.9818128152, &
                                     14379.0966291692, &
                                     14699.2114455232, &
                                     15060.6379503017, &
                                     15422.0644550801, &
                                     15783.4909598585, &
                                     16144.9174646370, &
                                     16506.3439694154, &
                                     16867.7704741939, &
                                     17229.1969789723, &
                                     17590.6234837508, &
                                     17952.0499885292, &
                                     18313.4764933076, &
                                     18674.9029980861, &
                                     19037.7137893185, &
                                     19400.5245805509, &
                                     19763.3353717833, &
                                     20126.1461630158, &
                                     20488.9569542482, &
                                     20851.7677454806, &
                                     21316.3317205843, &
                                     21780.8956956881, &
                                     22245.4596707918, &
                                     22710.0236458955, &
                                     23174.5876209993, &
                                     23639.1515961030, &
                                     24103.7155712067, &
                                     24669.0894320036, &
                                     25234.4632928006, &
                                     25799.8371535975, &
                                     26365.2110143944, &
                                     26930.5848751913, &
                                     27495.9587359882, &
                                     28061.3325967851, &
                                     28809.5393035569, &
                                     29557.7460103287, &
                                     30305.9527171004, &
                                     31054.1594238722, &
                                     31802.3661306440, &
                                     32550.5728374158, &
                                     33298.7795441876, &
                                     34198.1781454575, &
                                     35097.5767467274, &
                                     35996.9753479973, &
                                     36896.3739492672, &
                                     37795.7725505371, &
                                     38695.1711518071, &
                                     39594.5697530770, &
                                     40689.8247707462, &
                                     41785.0797884155, &
                                     42880.3348060848, &
                                     43975.5898237540, &
                                     45070.8448414233, &
                                     46166.0998590925, &
                                     47261.3548767618, &
                                     48631.3092437466, &
                                     50001.2636107314, &
                                     51371.2179777163, &
                                     52741.1723447011, &
                                     54111.1267116859, &
                                     55481.0810786707, &
                                     56851.0354456555, &
                                     58653.7772569097, &
                                     60456.5190681639, &
                                     62259.2608794181, &
                                     64062.0026906722, &
                                     65864.7445019264, &
                                     67667.4863131806, &
                                     69470.2281244348, &
                                     71657.2188844539, &
                                     73844.2096444731, &
                                     76031.2004044923, &
                                     78218.1911645114, &
                                     80405.1819245306, &
                                     82592.1726845498, &
                                     84375.3669064099 ]

 real(WP) :: kvvs_d_n2_o2(Lmax1,Lmax2) = Zero, kvvs_u_n2_o2(Lmax1,Lmax2) = Zero
 real(WP) :: kvvs_d_n2_no(Lmax1,Lmax3) = Zero, kvvs_u_n2_no(Lmax1,Lmax3) = Zero
 real(WP) :: kvvs_d_o2_n2(Lmax2,Lmax1) = Zero, kvvs_u_o2_n2(Lmax2,Lmax1) = Zero
 real(WP) :: kvvs_d_o2_no(Lmax2,Lmax3) = Zero, kvvs_u_o2_no(Lmax2,Lmax3) = Zero
 real(WP) :: kvvs_d_no_n2(Lmax3,Lmax1) = Zero, kvvs_u_no_n2(Lmax3,Lmax1) = Zero
 real(WP) :: kvvs_d_no_o2(Lmax3,Lmax2) = Zero, kvvs_u_no_o2(Lmax3,Lmax2) = Zero

 real(WP), dimension(Lmax1,Lmax1) :: kvv_down_n2, kvv_up_n2
 real(WP), dimension(Lmax2,Lmax2) :: kvv_down_o2, kvv_up_o2
 real(WP), dimension(Lmax3,Lmax3) :: kvv_down_no, kvv_up_no

 real(WP), dimension(l1) :: RDn2 = Zero, RZn2 = Zero, RVTn2 = Zero, RVVn2 = Zero, RVVsn2 = Zero
 real(WP), dimension(l2) :: RDo2 = Zero, RZo2 = Zero, RVTo2 = Zero, RVVo2 = Zero, RVVso2 = Zero
 real(WP), dimension(l3) :: RDno = Zero, RZno = Zero, RVTno = Zero, RVVno = Zero, RVVsno = Zero

 real(WP), dimension(l1) :: en2i_b
 real(WP), dimension(l2) :: eo2i_b
 real(WP), dimension(l3) :: enoi_b

 real(WP), dimension(l1) :: Kdr_n2
 real(WP), dimension(l2) :: Kdr_o2
 real(WP), dimension(l3) :: Kdr_no

 real(WP), dimension(l1) :: nn2i_b
 real(WP), dimension(l2) :: no2i_b
 real(WP), dimension(l3) :: nnoi_b

 real(WP), dimension(5,l1) :: kd_n2 = 0.0_WP, kr_n2 = 0.0_WP
 real(WP), dimension(5,l2) :: kd_o2 = 0.0_WP, kr_o2 = 0.0_WP
 real(WP), dimension(5,l3) :: kd_no = 0.0_WP, kr_no = 0.0_WP

 real(WP), dimension(5,Lmax1) :: kvt_up_n2 = 0.0_WP, kvt_down_n2 = 0.0_WP
 real(WP), dimension(5,Lmax2) :: kvt_up_o2 = 0.0_WP, kvt_down_o2 = 0.0_WP
 real(WP), dimension(5,Lmax3) :: kvt_up_no = 0.0_WP, kvt_down_no = 0.0_WP

! real(WP), dimension(l1,l3) :: kf_n2, kb_n2
! real(WP), dimension(l2,l3) :: kf_o2, kb_o2

 real(WP), dimension(l1,l3) :: Kz_n2
 real(WP), dimension(l2,l3) :: Kz_o2

 real(WP), dimension(Lmax1) :: Kvt_n2
 real(WP), dimension(Lmax2) :: Kvt_o2
 real(WP), dimension(Lmax3) :: Kvt_no

 real(WP), dimension(Lmax1) :: deps_n2
 real(WP), dimension(Lmax2) :: deps_o2
 real(WP), dimension(Lmax3) :: deps_no

! EXCHANGE
! constants for N2,O2
! AA = [3e-17, 4e-16]; ! m^3/sec
 real(WP), parameter, dimension(2) :: AA = [8e-17_WP, 4e-16_WP] !m3/s
 real(WP), parameter, dimension(2) :: bb = [0.0, -0.39]
 real(WP), parameter :: U_EX = 999999999 !Inf ! 3*T

  real(WP), parameter, dimension(l1) :: en2_i = [0.0,                   &
                                                 4.616066402727000e-20, &
                                                 9.175391125758000e-20, &
                                                 1.367797416909300e-19, &
                                                 1.812381553273200e-19, &
                                                 2.251291521667500e-19, &
                                                 2.684527322092200e-19, &
                                                 3.112088954547300e-19, &
                                                 3.533976419032800e-19, &
                                                 3.950189715548700e-19, &
                                                 4.360728844095000e-19, &
                                                 4.765593804671700e-19, &
                                                 5.164784597278800e-19, &
                                                 5.558301221916300e-19, &
                                                 5.946143678584200e-19, &
                                                 6.328311967282500e-19, &
                                                 6.704806088011200e-19, &
                                                 7.075626040770300e-19, &
                                                 7.440771825559800e-19, &
                                                 7.800243442379700e-19, &
                                                 8.154040891230000e-19, &
                                                 8.502164172110701e-19, &
                                                 8.844613285021801e-19, &
                                                 9.181388229963301e-19, &
                                                 9.512489006935200e-19, &
                                                 9.837915615937501e-19, &
                                                 1.015766805697020e-18, &
                                                 1.047174633003330e-18, &
                                                 1.078015043512680e-18, &
                                                 1.108288037225070e-18, &
                                                 1.137993614140500e-18, &
                                                 1.167131774258970e-18, &
                                                 1.195702517580480e-18, &
                                                 1.223705844105030e-18, &
                                                 1.251141753832620e-18, &
                                                 1.278010246763250e-18, &
                                                 1.304311322896920e-18, &
                                                 1.330044982233630e-18, &
                                                 1.355211224773380e-18, &
                                                 1.379810050516170e-18, &
                                                 1.403841459462000e-18, &
                                                 1.427305451610870e-18, &
                                                 1.450202026962780e-18, &
                                                 1.472531185517730e-18, &
                                                 1.494292927275720e-18, &
                                                 1.515487252236750e-18, &
                                                 1.536114160400820e-18]

 real(WP), parameter, dimension(l2) :: eo2_i = [ 0.0                  , &
                                                 3.083208945297000e-20, &
                                                 6.118948245150000e-20, &
                                                 9.107217899559001e-20, &
                                                 1.204801790852400e-19, &
                                                 1.494134827204500e-19, &
                                                 1.778720899012200e-19, &
                                                 2.058560006275500e-19, &
                                                 2.333652148994400e-19, &
                                                 2.603997327168900e-19, &
                                                 2.869595540799000e-19, &
                                                 3.130446789884700e-19, &
                                                 3.386551074426000e-19, &
                                                 3.637908394422900e-19, &
                                                 3.884518749875400e-19, &
                                                 4.126382140783500e-19, &
                                                 4.363498567147200e-19, &
                                                 4.595868028966500e-19, &
                                                 4.823490526241400e-19, &
                                                 5.046366058971900e-19, &
                                                 5.264494627158001e-19, &
                                                 5.477876230799700e-19, &
                                                 5.686510869897000e-19, &
                                                 5.890398544449901e-19, &
                                                 6.089539254458401e-19, &
                                                 6.283932999922501e-19, &
                                                 6.473579780842200e-19, &
                                                 6.658479597217500e-19, &
                                                 6.838632449048401e-19, &
                                                 7.014038336334900e-19, &
                                                 7.184697259077000e-19, &
                                                 7.350609217274700e-19, &
                                                 7.511774210928000e-19, &
                                                 7.668192240036900e-19, &
                                                 7.819863304601400e-19, &
                                                 7.966787404621501e-19]

 real(WP), parameter, dimension(l3) :: eno_i = [ 0.0                  , &
                                                 3.716837576595000e-20, &
                                                 7.377904263405000e-20, &
                                                 1.098320006043000e-19, &
                                                 1.453272496767000e-19, &
                                                 1.802647898512500e-19, &
                                                 2.146446211279500e-19, &
                                                 2.484667435068000e-19, &
                                                 2.817311569878000e-19, &
                                                 3.144378615709500e-19, &
                                                 3.465868572562500e-19, &
                                                 3.781781440437000e-19, &
                                                 4.092117219333000e-19, &
                                                 4.396875909250500e-19, &
                                                 4.696057510189500e-19, &
                                                 4.989662022150000e-19, &
                                                 5.277689445132000e-19, &
                                                 5.560139779135501e-19, &
                                                 5.837013024160500e-19, &
                                                 6.108309180207000e-19, &
                                                 6.374028247275000e-19, &
                                                 6.634170225364500e-19, &
                                                 6.888735114475500e-19, &
                                                 7.137722914608001e-19, &
                                                 7.381133625762000e-19, &
                                                 7.618967247937500e-19, &
                                                 7.851223781134500e-19, &
                                                 8.077903225353000e-19, &
                                                 8.299005580593001e-19, &
                                                 8.514530846854500e-19, &
                                                 8.724479024137500e-19, &
                                                 8.928850112442000e-19, &
                                                 9.127644111767999e-19, &
                                                 9.320861022115499e-19, &
                                                 9.508500843484500e-19, &
                                                 9.690563575875000e-19, &
                                                 9.867049219287001e-19, &
                                                 1.003795777372050e-18, &
                                                 1.020328923917550e-18]

 real(WP), parameter :: en2_0 = 2.329311331249500e-20
 real(WP), parameter :: eo2_0 = 1.559405589690000e-20
 real(WP), parameter :: eno_0 = 1.879332871966875e-20

 End module constants
